{% extends 'OM_header.html' %}
{% block addr%}Project Task{% endblock addr%}
{% block user %}Welcome, {{request.session.name}}{% endblock user %}
{% block style %}
<title>WFM :: MANAGER PROJECT TASK</title>
<style>
    .table-responsive.listofEmpHeight,
    .table-responsive.projectsHeight {
        height: 340px;
    }

    .popup-container {
        display: none;
        position: fixed;
        top: 60%;
        left: 62%;
        transform: translate(-50%, -50%);
        padding: 20px;
        background-color: #fff;
        border: 1px solid #ccc;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        z-index: 1000;
        width: 25vw;
        /* height: 25vh; */
        /* backface-visibility: hidden; */
    }

    .popup-content {
        text-align: center;
    }

    a.cmProjectsColor {
        background: #09796b;
        color: #fff !important;
    }

    a.cmProjectsColor:hover {
        background: #09796b;
        color: #fff !important;
    }

    .thcolor:hover {
        background-color: white !important;
    }

    .tdcolor:hover {
        background-color: rgb(219, 214, 214) !important;
    }

    .drkclick {
        background-color: rgb(202, 178, 178) !important;
    }

    .grow {
        animation: bounce-in-right 3s ease;
        /* width: 98%; */

    }

    .card2 {
        height: 71.5vh;
    }

    .modal-body {
        height: 200px;
        overflow-y: scroll;
    }

    .card.dash-widget.ctm-border-radius.shadow-sm.grow1 {
        /* background-color: #0caf9c; */
        background-color: #da9517;
        border: none;
        color: white;
        margin: -0.6vw;
        margin-left: -0.6vw;
        width: 19.3vw;
        margin-left: -2vw;
        /* box-shadow: -1px 7px 10px darkcyan; */
        box-shadow: -1px 7px 10px #8a6625;
    }

    .card.dash-widget.ctm-border-radius.shadow-sm.grow2 {
        /* background-color: #e7b557; */
        background-color: #3282dd;
        border: none;
        color: white;
        margin: -0.6vw;
        margin-left: -0.6vw;
        width: 19.3vw;
        margin-left: -2vw;
        /* box-shadow:  -1px 7px 10px #8a6625; */
        box-shadow: -1px 7px 10px #1d4675;
    }

    .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
        /* background-color: #3282dd; */
        background-color: #0caf9c;
        border: none;
        color: white;
        margin: -0.6vw;
        margin-left: -0.6vw;
        width: 19.3vw;
        margin-left: -2vw;
        /* box-shadow:  -1px 7px 10px #1d4675; */
        box-shadow: -1px 7px 10px darkcyan;

    }

    #left1,
    #right1,
    #last1 {
        width: 21vw;
        background-color: rgb(255, 239, 220);
        overflow: hidden;
        overflow-y: scroll;
    }

    .thcolor th {
        font-size: larger;
    }

    .fontfamily {
        font-size: 13px !important;
        text-align: left;
        font-family: inherit;
        line-height: 20px;
    }

    .datefamily {
        text-align: right !important;
        font-family: inherit;
        font-size: 9px !important;
        position: relative;
        left: 4px;
        display: flex;
    }

    .datefamily:hover {
        cursor: context-menu;
    }

    .card-body {
        cursor: all-scroll;
    }

    hr.hori {
        margin-top: 1vh !important;
        width: 5vw;
        font-weight: bold !important;
        height: 5px;
        background-color: white;
        margin-bottom: 0.2vh !important;
    }

    .count {
        background-color: rgb(243, 86, 86);
        font-size: xx-small !important;
        border-radius: 20px 0px 12px 0px;
        font-weight: 650 !important;
    }

    .count:hover {
        cursor: context-menu;
    }

    .bubble.lnr.lnr-bubble.mr-2 {
        font-size: 20px;
    }

    hr.hori:hover {
        cursor: context-menu;
    }

    hr.hor1:hover {
        cursor: context-menu;
    }

    #emailModal:hover {
        cursor: context-menu;
    }

    #modalEmail {
        overflow-y: scroll;
        display: flex;
        max-height: 280px;
    }

    .modal-content {
        position: relative;
        display: flex;
        -ms-flex-direction: column;
        flex-direction: column;
        /* width: 50vw; */
        pointer-events: auto;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid rgba(0, 0, 0, .2);
        border-radius: .3rem;
        outline: 0;
        /* min-height: 400px; */
        /* margin-left: -20%; */
    }

    .modal-content.datauses {
        /* width: auto !important; */
        background-color: #fff;
        border: 1px solid rgba(0, 0, 0, .2);
        border-radius: .3rem;
        outline: 0;
        /* position: relative;
        left: 380px; */
    }

    #checkmove .statics {
        position: sticky !important;
        top: 0 !important;
    }

    .checkmovebtn {
        position: relative;
        right: 1vw;
    }

    #userComment {
        width: 70%;
    }

    .employee-office-table .table input {
        width: 100%;
        padding: 0px 5px;
        border: 1px solid #666;
        float: left;
    }

    .table-responsive {
        display: inline-flex;
    }

    .modal-content.addtask {
        position: absolute;
        display: flex;
        -ms-flex-direction: column;
        flex-direction: column;
        width: 100%;
        pointer-events: auto;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid rgba(0, 0, 0, .2);
        border-radius: .3rem;
        outline: 0;
        height: 75%;
        margin-left: 0;
        /* left: 20%; */
    }

    .profile {
        -webkit-clip-path: circle(50% at 50% 50%);
        clip-path: circle(50% at 50% 50%);
        width: 35px;
        float: left;
        padding: 2px;
        border-radius: 50px;
    }

    .profile5 {
        -webkit-clip-path: circle(50% at 50% 50%);
        clip-path: circle(50% at 50% 50%);
        width: 35px;
        float: right;
        padding: 2px;
        border-radius: 50px;
    }

    .txt5 {
        padding: 4px 0px 10px 20px;
        font-size: 12px;
        font-weight: 500;
        color: black;
        text-align: initial;
        line-height: normal;
        /* max-width: 38vw; */
        background-color: rgb(174, 217, 235);
        /* margin-right: 70px !important; */
        border-radius: 20px 0px 22px 0px;
        margin-left: 85px;
        display: flow-root;
        margin-right: 15px;
    }

    .profCont5 {
        padding-right: 10px;
        margin-bottom: 6px;
    }

    .modal-content.commentbox {
       /* position: relative;
  display: flex; */
  -ms-flex-direction: column;
        flex-direction: column;
        /* width: 50.1vw; */
        pointer-events: auto;
        background-color: #fff;
        background-clip: padding-box;
        border: 1px solid rgba(0, 0, 0, .2);
        border-radius: .3rem;
        outline: 0;
        /* min-height: 400px; */
        height: 80vh !important;
        overflow: hidden;
        /* overflow-y: scroll; */
    }

    
    .txt2 {
        padding: 4px 3px 10px 20px;
        font-size: 12px;
        font-weight: 500;
        color: black;
        text-align: initial;
        line-height: normal;
        max-width: 85%;
        background-color: rgb(241, 227, 207);
        margin-left: 35px;
        border-radius: 0px 30px 0px 30px;
        display: flow-root;
    }

    .profCont {
        padding-left: 15px;
        margin-bottom: 6px;
    }

    .card-right2 p {
        font-weight: 400;
    }

    .bubble.lnr {
        font-weight: 800;
        /* background: transparent;
        border: none;
        color: white; */
    }

    .commentername {
        background-color: rgb(241, 129, 64);
        color: white;
        border-radius: 2px 18px 0px 0px;
        margin: -3px 0px 2px -20px;
    }

    .mycomment {
        background-color: rgb(50, 112, 228);
        color: white;
        border-radius: 20px 0px 0px 0px;
        margin: -3px 0px 2px -20px;
    }

    .notification-details {
        display: flex;
        flex-direction: column;
        width: 100%;
    }
    .modal_dialog {
        max-width: 800px;
    }
    .row {
        display: flex;
    }

    .team-chat {
        order: 1;
        margin-right: auto;
    }

    .my-chat {
        order: 2;
        margin-left: auto;
    }

    .heading {
        padding: 5px;
    }

    .bubble {
        background: transparent;
        border: none;
        color: white;
    }

    .addtask1 {
        border-bottom: none !important;
         height: 4.5vh; 
        font-size: 14px;
        /* position: relative;
        right: 10px; */
    }
    .card-header {
      background: none;
      padding: 0.8rem;
      border-bottom: 1px solid #ededed;
    }
    .dot-circle {
            width: 8px;
            height: 8px;
            color: rgb(231, 41, 41);
            border: 2px solid  rgb(231, 41, 41);
            border-radius: 50%;
            background:  rgb(231, 41, 41);
            width: 8px;
            height: 8px;
            color: rgb(231, 41, 41);
            border: 2px solid  rgb(231, 41, 41);
            border-radius: 50%;
            background: rgb(231, 41, 41);
            position: absolute;
            bottom: 19px;
            left: 42px;
    }
    .teamList {
  width: 3%;
  position: absolute;
  right: 14%;
}
.TeamDiv {
  display: inline-block;
  position: absolute;
  top: 8%;
  width: 45%;
  text-align: center;
  border-radius: 10px;
  right: 18%;
  z-index: 1;
}
.teamMember {
  border: 3px solid darkgray;
  font-size: 13px;
}
.teamList:hover {
  background-color: rgb(40, 184, 184);
  border-radius: 18px;
  box-shadow: 2px 4px 13px 6px cadetblue;
}
.task_description {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 280px;
}
b{
    font-weight:600;
}

/* --------------------------------------------------------------------modal CSS start-------------------------------------------------------------------------------- */
.modal-dialog.modal-lg.modal-dialog-centered.dialogdesk.chat_dialog {
  max-width: 1100px;
}
.modal-content.contentdesk {
  width: 100%;
  margin: auto;
  min-height: 590px !important;
}
.lnr.lnr-users,
.lnr.lnr-paperclip {
    font-size: 25px;
    font-weight: 700;
}
.popup_icons_user, .popup_icons_attach {
  font-size: 25px;
  font-weight: 700;
  text-align: center;
  margin-left: 35%;
  height: 30px;
}
.file_name_images:hover {
  background-color: darkcyan;
  color: white;
}
.file_name_images {
  width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;

}
.file_name_images a:hover {
  color: #fff !important;
  padding: 10px;
}
.largerdis {
  height: 165px;
  overflow: auto;
}
.log_icon {
  height: 30px;
}
hr.horizontal_fir {
  margin-top: 5px !important;
  width: 40px;
  font-weight: bold !important;
  height: 5px !important;
  background-color: brown;
  margin-bottom: 0vh !important;
}
hr.horizontal_sec {
    margin-top: 3px !important;
  width: 40px;
  font-weight: bold !important;
  height: 5px !important;
  background-color: brown;
  margin-bottom: 0vh !important;
  margin-left: -5px;
}
.card.text-center.completechat_first,.card.text-center.completechat_sec,.card.text-center.completechat_last, .card.chat_chat_details {
  margin-top: 1% !important;
  margin-bottom: 0%;
}
.card-body.chat_classs {
  height: 220px !important;
  overflow: auto;
  background-color: beige;
}
.notification-details {
        display: flex;
        flex-direction: column;
        /* width: 47vw; */
    }
    .empty {
  overflow: auto;
  resize: vertical;
  width: 90% !important;
  float: left;
}
.send_image {
  width: 20px;
}
.card-body.chat_details {
  height: 290px;
  overflow: auto;
  background: lavender;
}
.teamMember_second {
        border: 3px solid darkgray;
        font-size: 13px;
    }
    .teamMember_second thead tr, .log_table thead tr {
  background: bisque;
}
.teamMember_second tbody tr:hover, .log_table tbody tr:hover{
  background: bisque;
}
.modal-content.teamMemberModal {
  margin-top: 40%;
  width: 120%;
  min-height: auto;
}
.modal-body.teampopup {
  background: lavender;
  box-shadow: 0px 5px 25px 15px #09796b;
}
.modal-footer.teampopup {
  padding-bottom: 0px;
  padding-top: 10px;
}
.col-md-12.popuptable {
  overflow: auto;
    overflow-x: auto;
    overflow-y: auto;
}
.col-md-12.popuptable {
  max-height: 300px;
}
.close.teamclose {
  margin-top: -3%;
  position: relative;
  bottom: 10px;
}
.savechangesbtn {
  border-radius: 20px;
  border-bottom: 3px solid black;
  background-color: teal;
}
.savechangesbtn:hover {
  background-color: lightseagreen;
  border: none;
}
.all_items {
  min-width: 100%;
  text-align: center;
  border: 2px solid darkgray;
  margin: 10px auto;
  background-color: antiquewhite;
  box-shadow: 0px 0px 38px 0px darkcyan;
  max-width: 300px;
  margin-left: -50%;
}
.showdatas{
    margin: 10% auto;
}
.chat_refresh_list, .task_description{
    cursor: pointer;
}
/* --------------------------------------------------------------------modal CSS End-------------------------------------------------------------------------------- */
    /* tbody{
        box-sizing: border-box !important;
    } */
    @media only screen and (max-width: 1388px){
        .table.custom-table > tbody > tr > td:last-child, .table.custom-table > thead > tr > th:last-child {
        padding-right: 0px;
        }

        #left1, #right1, #last1 {
        position: relative;
        right: 7px !important;
        }

        
    }
    @media only screen and (max-width: 1259px){
        .teamList {
  position: absolute;
  right: 20%;
}
    }
    @media only screen and (max-width: 1200px){
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
        position: relative;
        left: 8px;
        bottom: 10px;
        }

        .cardinfo {
        display: ruby !important;
        position: relative;
        top: 15px;
        }
        .card-body .card-right2 {
        padding-bottom: 20px !important;
        }

        .card-title.mb-0.d-inline-block {
        font-size: 16px;
        }

        .thcolor {
        font-size: 13px;
        }
    }
    @media only screen and (max-width: 1199px){
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
        width: 17.3vw;
        margin-left: -2vw;
        }

        #left1, #right1, #last1 {
        width: 19vw;
        }
        hr.hori {
        width: 4vw;
        }
        .bubble.lnr.lnr-bubble.mr-2 {
        font-size: 17px;
        position: relative;
        bottom: 5px;
        }
        .count {
        font-size: xx-small !important;
        border-radius: 10px 0px 12px 0px;
        }
        .dot-circle {
        position: absolute;
        bottom: 19px;
        left: 30px;
        }
        .dash-widget .card-body {
        align-items: flex-start;
        }
        .card-title.mb-0.d-inline-block {
        font-size: 15px;
        }

        .thcolor {
        font-size: 11px;
        }
        .TeamDiv{
            position: absolute;
            right: 40%;
        }
        .task_description{
            max-width: 180px;
        }

    }
    @media only screen and (max-width: 1060px){
        #left1, #right1, #last1 {
        width: 18vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
        width: 16.3vw;
        margin-left: -2vw;
        }
        .task_description{
            max-width: 130px;
        }
    }
    @media only screen and (max-width: 991px){
        #showsidebar,
        #fullscreen {
            display: none;
        }
        .card {
            margin-bottom: 15px;
            position: relative;
            top: 30px;
        }
        #left1, #right1, #last1 {
            width: 29vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
            width: 27.3vw;
            position: relative;
            top: -8px;
        }
        hr.hori {
            width: 6vw;
        }
        .datefamily{
            font-size: 11px;
        }
        .bubble.lnr.lnr-bubble.mr-2 {
            font-size: 20px;
        }
        .dot-circle {
            position: absolute;
            bottom: 19px;
            left: 37px;
        }
        .card-title.mb-0.d-inline-block {
            font-size: 18px;
        }
        .thcolor {
            font-size: 15px;
        }
        .lowerfooter {
            position: relative;
            top: 25px;
            margin-bottom: 40px !important;
        }
        /* .modal-content.commentbox {
            position: absolute;
            left: 70px;
        } */
        .popup-container {
            position: fixed;
            top: 40%;
            left: 52%;
            width: 35vw;
        }
        .teamList{
            display: none;
        }
        .task_description{
            max-width: 240px;
        }
        .completechat_first,.completechat_sec,.completechat_last{
            position: relative;
            top: 10px;
        }
        
    @media only screen and (max-width: 865px){
        #left1, #right1, #last1 {
            width: 27vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
        width: 24.3vw;
        }
        .dot-circle {
        position: absolute;
        bottom: 19px;
        left: 32px;
        }
        .task_description{
            max-width: 180px;
        }
        .empty{
            width: 80% !important;
        }
        .chat_send_inner{
            margin-left: 5%;
        }
        .chat_icon {
            max-width: auto;
            width: 25px;
        }
    }
    @media only screen and (max-width: 767px){
        .card-title.mb-0.d-inline-block {
        font-size: 16px;
        }
        .txt5, .txt2{
            font-size: 13px;
        }
        .thcolor {
        font-size: 13px;
        }
        #left1, #right1, #last1 {
            width: 28vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
            width: 24.3vw;
            position: relative;
            left: -12px;
        }
        .fontfamily {
            font-size: 13px !important;
            text-align: justify;
            line-height: 1;
            font-weight: 200 !important;
        }
        .lowest .datecard1, .lowest .datecard2 {
            width: 50%;
        }
        .bubble.lnr.lnr-bubble.mr-2 {
            font-size: 16px;
        }
        .dot-circle {
            position: absolute;
            bottom: 19px;
            left: 50px;
        }
        .cardhori {
            width: 30%;
            margin-bottom: 6px;
        }
        .count {
            font-size: x-small !important;
            border-radius: 0px 0px 9px 9px;
        }
        /* .modal-content.commentbox {
            position: absolute;
            left: 150px;
        } */
        /* .modal-content.datauses {
            position: relative;
            left: 250px;
        } */
        .inner_list{
            width: auto !important;
        }
        hr.horizontal_fir{
            width: 55px;
        }
        hr.horizontal_sec{
            width: 55px !important;
            margin-left: 0px !important;
        }
        .modal-content.teamMemberModal {
            margin-top: 30%;
            width: 100%;
        }
    }
     
    @media only screen and (max-width: 703px){
        #left1, #right1, #last1 {
            width: 26vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
            width: 22.3vw;
            position: relative;
            left: -12px;
        }
        .dot-circle {
            position: absolute;
            bottom: 19px;
            left: 42px;
        }
    }
    @media only screen and (max-width: 575px){
        #left1, #right1, #last1 {
            width: 26vw;
        }
        .card.dash-widget.ctm-border-radius.shadow-sm.grow1, 
        .card.dash-widget.ctm-border-radius.shadow-sm.grow2,  
        .card.dash-widget.ctm-border-radius.shadow-sm.grow3 {
            width: 22.3vw;
            position: relative;
            left: -20px;
        }
        .dot-circle {
            position: absolute;
            bottom: 19px;
            left: 36px;
        }
        .card-title.mb-0.d-inline-block {
            font-size: 14px;
            font-weight: 600;
        }
        /* .modal-content.commentbox {
        position: absolute;
        left: 240px;
        width: 53vw;
        } */
        .popup-container {
            width: 45vw;
        }
        .row.w-100.align-items-center {
            display: contents;
        }
        .row.mainicons {
            width: 15%;
            display: block ruby;
        }
        .table.custom-table.table-hover.log_table tr th, .table.custom-table.table-hover.log_table tr td {
            font-size: 10px !important;
        }
        .inner_list{
            margin-top: 5%;
        }
    }
    @media only screen and (max-width: 438px){
        .addtask1 {
            height: 4.5vh;
            font-size: 10px;
        }
    }
    @media only screen and (max-width: 427px){
        /* .modal-content.datauses {
            position: relative;
            left: 110px;
        } */
    }
    @media only screen and (max-width: 388px){
        .addtask1 {
            width: 26vw;
        }
    }
}
</style>
{% endblock style %}
{% block body %}
<div class="col-xl-9 col-lg-8  col-md-12 dashboardbody">
    <div class="row">
        <div class="col-md-12 d-flex">
            <div class="card ctm-border-radius shadow-sm flex-fill grow">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <h5 class="card-title mb-0 d-inline-block">{{request.session.project_name}}</h5>
                    <img src="../static/img/info.png" class="teamList" alt="Icon Description">
                    <a href="javascript:void(0)"
                        class="btn btn-theme button-1 ctm-border-radius text-white float-right addtask1"
                        data-toggle="modal" data-target="#add_event"><span><i class="fa fa-plus"></i></span>
                        Add Task</a>
                </div>
                <form method="post" enctype="multipart/form-data">
                    {%csrf_token%}
                    <table class="table custom-table table1Pending" id="myTable1">
                        <thead style="position: sticky;
                        top: 0;
                        z-index: 1;">
                            <tr class="thcolor">
                                <th>Task List</th>
                                <th>Development</th>
                                <th>Completed</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="row">
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                            <div class="card2 dash-widget ctm-border-radius shadow-sm grow" id="left1">
                                                {% for i,count,logs,task_chat,task_crew,task,crews,chats,task_logs,attachments,all_crews in tasks_list %}
                                                <div class="card-body cardinfo" draggable="true" id="{{i.id}}"
                                                    ondragstart="drag(event)">
                                                    <!-- <input type="" value="{{i.id}}" > -->
                                                    <div class="card-right2">
                                                        <div class="card dash-widget ctm-border-radius shadow-sm grow1">
                                                            <div class="card-body innercardbody" style="padding: 10px;">
                                                               
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <h4 class="text-left chat_refresh_list" value="{{i.id}}" style="font-weight: bolder ;" id="first_heading{{i.id}}" data-toggle="modal" data-target=".taskModal{{i.id}}">{{i.task_heading}}  </h4>
                                                                    </div>
                                                                    <!-- <div class="col-md-5 text-right">
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Phase {{i.phase}} </p>
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Version : V{{i.project_version}} </p>
                                                                        <p class="" style="font-weight: bolder ;text-align: right; font-size: 12px;" >Priority : {{i.priority}} </p>
                                                                    </div> -->
                                                                </div>
                                                                <p class="fontfamily task_description" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-height: 19px;" title="{{i.description|safe}}" data-toggle="modal" data-target=".taskModal{{i.id}}"> {{i.description|safe}}</p>
                                                            </div>
                                                            <div class="row lowest">
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Requirement Date">
                                                                        {{i.assigning_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Target Date">
                                                                        {{i.target_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <p class="datefamily" title="Completed Date">
                                                                        {{i.complete_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <button value="{{i.id}}"
                                                                        class="comment_button Modal1{{forloop.counter}} tasks_chat bubble lnr lnr-bubble mr-2"
                                                                        title="Comments"></button>
                                                                        {% if task_chat|length > 0 %}
                                                                        <div class="dot-circle"></div>
                                                                        {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class="row lowest">
                                                                <div class="col-md-3 cardhori">
                                                                    <hr title="Database Integration ({{i.database}})" class="hori" {% if i.ui|length > 1 %} style="background-color: #007514;"
                                                                        {% endif %} onclick="openPopup1()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr title="UI Integration ({{i.ui}})" class="hori" {% if i.database|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        onclick="openPopup2()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr title="Backend Integration ({{i.backend}})" class="hori" {% if i.backend|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        onclick="openPopup3()">
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p title="Task ID (Rework Count)" class="count"
                                                                        data-toggle="modal"
                                                                        data-target="#add_Comment_event_first{{i.id}}">
                                                                        {{i.projec_task_id}}
                                                                        ({{count}})</p>
                                                                </div>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>
                                                <div class="modal fade" id="emailModal1{{forloop.counter}}"
                                                    tabindex="-1" aria-labelledby="exampleModalLabel"
                                                    aria-hidden="true">
                                                    <div class="modal-dialog modal_dialog">
                                                        <div class="modal-content commentbox">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">
                                                                    <b>Comments</b>
                                                                </h5>
                                                                <button type="button" class="close stopInterval"
                                                                    data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body" id="modalEmail{{i.id}}">
                                                                <div class="notification-details"
                                                                    id="notificationdetails{{i.id}}">
                                                                    {% for chat in chats %}
                                                                    {% if chat.user_name == request.session.name %}
                                                                    <div class="row">
                                                                        <div class="profCont5 my-chat">
                                                                            <img class="profile5"
                                                                                src="../{{request.session.profile_pic}}">
                                                                            <div class="txt5">
                                                                                <div class="row mycomment">
                                                                                    <div class="col-md-12">
                                                                                        {{chat.user_name}}
                                                                                    </div>
                                                                                </div>
                                                                            {{chat.description}}
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                                    {% else %}

                                                                    <div class="row">
                                                                        <div class="profCont team-chat">
                                                                            <img class="profile"
                                                                                src="../static/img/profiles/img-2.jpg">
                                                                            <div class="txt2">
                                                                                <div class="row commentername">
                                                                                    <div class="col-md-12 ">
                                                                                        <p> {{chat.user_name}}</p>
                                                                                    </div>
                                                                                </div>
                                                                                {{chat.description}}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    {% endif %}

                                                                {% endfor %}
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <label for="comnt" style="font-weight: 600;"></label>
                                                                <textarea name="commentsemphr" class="empty"
                                                                    id="comnt{{i.id}}" cols="10" rows="2"
                                                                    placeholder="Write Your Comments here...."></textarea>
                                                                <button name="chat_send" id="addEmpcomnt"
                                                                    value="{{i.id}}"
                                                                    class="chat_send btn btn-theme button-1 text-white ctm-border-radius mt-1">Send</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="add_Comment_event_first{{i.id}}" class="modal fade"
                                                    role="dialog">
                                                    <div class="modal-dialog modal-dialog-centered modal_dialog" role="document"
                                                        style="max-width: 850px;">
                                                        <div class="modal-content datauses">
                                                            <div class="modal-header">
                                                                <h4 class="modal-title">Status Log</h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="employee-office-table"
                                                                    style="box-shadow: none;">
                                                                    <div class="table-responsive">
                                                                        <table class="table custom-table table-hover">
                                                                            <thead id="checkmove">
                                                                                <tr class="statics">
                                                                                    <th>Sr.No.</th>
                                                                                    <th>From</th>
                                                                                    <th>To</th>
                                                                                    <th>Performed By</th>
                                                                                    <th>Date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody style="position: relative;">
                                                                                {% for k in logs %}
                                                                                <tr>
                                                                                    <td>{{forloop.counter}}</td>
                                                                                    <td>{{k.from_status}}</td>
                                                                                    <td>{{k.to_status}}</td>
                                                                                    <td>{{k.name}}</td>
                                                                                    <td>{{k.dates}}</td>

                                                                                </tr>
                                                                                {% endfor %}

                                                                            </tbody>
                                                                        </table>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer text-center">
                                                                <div class="row">
                                                                    <button name="cancelEmp"
                                                                        class="btn btn-danger text-white ctm-border-radius checkmovebtn"
                                                                        data-dismiss="modal"
                                                                        aria-label="Close">Cancel</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <script>
                                                    $(document).ready(function () {
                                                        $(".Modal1{{forloop.counter}}").click(function () {
                                                            $('#emailModal1{{forloop.counter}}').modal('show');
                                                        });
                                                    });
                                                </script>
                                                <div class="modal fade deskmodal taskModal{{i.id}}" id="taskModal{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-lg modal-dialog-centered dialogdesk chat_dialog" role="document">
                                                        <div class="modal-content contentdesk">
                                                            <div class="modal-header" style="padding: 0.5rem 1rem;">
                                                                <div class="row w-100 align-items-center">
                                                                    <div class="col-md-9 col-sm-7 task_details_head">
                                                                        <h4 class="modal-title text-left">Task Details</h4>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2 text-right">
                                                                        <div class="lnr lnr-paperclip popup_icons_attach" id="dropdownMenuButton{{task.id}}"></div>
                                                                            <div class="dropdown-menu attch{{task.id}} all_items" aria-labelledby="dropdownMenuButton{{task.id}}">
                                                                                <ul>
                                                                                    {% for i in attachments %}
                                                                                    <li class="file_name_images text-left" title="{{ i.file_name }}">
                                                                                        <a style="color: black; padding: 10px;" href="/static/uploads/task_files/{{ i.file_name }}" target="_blank">
                                                                                            {% if i.file_name|lower|slice:'-4:' == '.pdf' %}
                                                                                                <img src="../static/img/pdf_icon.png" alt="PDF Icon" width="20" height="20">
                                                                                            {% elif i.file_name|lower|slice:'-4:' == '.doc' or i.file_name|lower|slice:'-5:' == '.docx' %}
                                                                                                <img src="../static/img/doc-icon.png" alt="Word Icon" width="20" height="20">
                                                                                            {% elif i.file_name|lower|slice:'-4:' == '.xls' or i.file_name|lower|slice:'-5:' == '.xlsx' %}
                                                                                                <img src="../static/img/xls_icon.png" alt="Excel Icon" width="20" height="20">
                                                                                            {% elif i.file_name|lower|slice:'-4:' == '.jpg' or i.file_name|lower|slice:'-5:' == '.jpeg' or i.file_name|lower|slice:'-4:' == '.png' %}
                                                                                                <img src="../static/img/jpg_icon.png" alt="Image Icon" width="20" height="20">
                                                                                            {% else %}
                                                                                                <img src="../static/img/Default_icon.png" alt="Default Icon" width="20" height="20">
                                                                                            {% endif %}
                                                                                            {{ i.file_name }} 
                                                                                        </a>
                                                                                    </li>
                                                                                    {% endfor %}
                                                                                    <!-- <li>Andrew</li>
                                                                                    <li>Roy</li>
                                                                                    <li>Sam</li>
                                                                                    <li>Johnson</li>
                                                                                    <li>Ponting</li>
                                                                                    <li>Ricky</li> -->
    
                                                                                </ul>
                                                                            </div>
    
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2 text-right">
                                                                        <div class="lnr lnr-users teamList_second popup_icons_user" id="teamList_second{{i.id}}"
                                                                        data-toggle="modal"  data-target="#tablemodal{{task.id}}"></div>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-1 text-right">
                                                                        <button type="button" id="close_chat{{task.id}}" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-body modalbodydesk" style="height: 540px; overflow-y: hidden; padding-top: 0px;">
                                                                <div class="row">
                                                                    <div class="col-md-8 col-sm-8">
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                                <div class="largerdis">
                                                                                    <h5 class="text-left">{{task.task_heading}}</h5>
                                                                                    <p class="text-left">
                                                                                    {{task.description|safe}}
                                                                                    </p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mainicons">
                                                                            <div class="col-md-1 col-sm-2 icons text-center">
                                                                                <img src="../static/img/double-chat-icon.svg" class="chat_icon" id="chat_icon{{task.id}}" value="task.id" alt="Icon Description">
                                                                                <hr class="horizontal_fir ">
                                                                            </div>
                                                                            <div class="col-md-1 col-sm-2 icons text-center">
                                                                                <img src="../static/img/file-log-color-red-icon.svg" class="log_icon" id="log_icon{{task.id}}" alt="Icon Description">
                                                                                <hr class="horizontal_sec text-left">
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                            <div class="card text-center completechat_first{{task.id}}" id="completechat{{task.id}}">
                                                                                    <div class="card-body chat_classs" id="modalEmail_inner_first{{task.id}}">
                                                                                        <div class="notification-details"
                                                                                        id="notificationdetails_inner{{task.id}}">
                                                                                        {% for chat in chats %}
                                                                                        {% if chat.user_name == request.session.name %}
                                                                                        <div class="row">
                                                                                            <div class="profCont5 my-chat">
                                                                                                <img class="profile5"
                                                                                                    src="../{{request.session.profile_pic}}">
                                                                                                <div class="txt5">
                                                                                                    <div class="row mycomment">
                                                                                                        <div class="col-md-12">
                                                                                                            {{chat.user_name}}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
    
                                                                                        {% else %}
    
                                                                                        <div class="row">
                                                                                            <div class="profCont team-chat">
                                                                                                <img class="profile"
                                                                                                    src="../static/img/profiles/img-2.jpg">
                                                                                                <div class="txt2">
                                                                                                    <div class="row commentername">
                                                                                                        <div class="col-md-12 ">
                                                                                                            <p> {{chat.user_name}}</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}
    
                                                                                    {% endfor %}
                                                                                    </div>
                                                                                    </div>
                                                                                    <div class="card-footer">
                                                                                        <label for="comnt" style="font-weight: 600; display: none;"></label>
                                                                                        <textarea name="commentsemphr" class="empty"
                                                                                            id="comnt_inner{{task.id}}" cols="10" rows="2"
                                                                                            placeholder="Write Your Comments here...."></textarea>
                                                                                        <button name="chat_send" id="chat_send_inner{{ task.id }}"
                                                                                            value="{{task.id}}"
                                                                                            class="chat_send_inner btn btn-theme button-1 text-white ctm-border-radius mt-3">
                                                                                            <img src="../static/img/send-paper-svgrepo-com.svg" alt="Send" class="send_image">
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="card chat_chat_details" id="chat_chat_details{{task.id}}">
    
                                                                                    <div class="card-body chat_details">
                                                                                        <div class="employee-office-table"
                                                                                        style="box-shadow: none;">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table custom-table table-hover log_table">
                                                                                                <thead id="checkmove">
                                                                                                    <tr class="statics">
                                                                                                        <th>Sr.No.</th>
                                                                                                        <th>From</th>
                                                                                                        <th>To</th>
                                                                                                        <th>Performed By</th>
                                                                                                        <th>Date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody style="position: relative;">
                                                                                                    {% for log in task_logs %}
                                                                                                    <tr>
                                                                                                        <td>{{forloop.counter}}</td>
                                                                                                        <td>{{log.from_status}}</td>
                                                                                                        <td>{{log.to_status}}</td>
                                                                                                        <td>{{log.name}}</td>
                                                                                                        <td>{{log.dates}}</td>
                                                                                                    </tr>
                                                                                                    {% endfor %}
    
                                                                                                </tbody>
                                                                                            </table>
    
                                                                                        </div>
                                                                                    </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4 col-sm-4">
                                                                        <div class="showdatas">
                                                                            <div class="card inner_list" style="width: auto;">
                                                                                <ul class="list-group list-group-flush text-left">
                                                                                <li class="list-group-item">Assignee: {{task.assignee}}</li>
                                                                                <li class="list-group-item">Phase: Phase {{task.phase}}</li>
                                                                                <li class="list-group-item">Versio: v{{task.project_version}}</li>
                                                                                <li class="list-group-item">Priority:{{task.priority}}</li>
                                                                                <select class="list-group-item status_dropdown">
    
                                                                                    <option {% if task.status == 'Task List' %} selected {% endif %}
                                                                                        {% if task.status == 'pending' %} selected {% endif %}
                                                                                        value="{{task.id}}/Task List">Status: Task</option>
                                                                                    <option {% if task.status == 'Development' %} selected {% endif %}
                                                                                        {% if task.status == 'development' %} selected {% endif %}
                                                                                         value="{{task.id}}/Development">Status: Development</option>
                                                                                    <option {% if task.status == 'Completed' %} selected {% endif %}
                                                                                        {% if task.status == 'completed' %} selected {% endif %}
                                                                                        value="{{task.id}}/Completed">Status: Completed</option>
    
                                                                                </select>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
    
                                                <div class="modal fade deskmodal inner_modal" id="tablemodal{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                <!-- <div class="modal  tableModalcheck" id="tablemodal{{i.id}}" role="dialog"> -->
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content teamMemberModal ">
    
                                                        <div class="modal-body teampopup "  style="overflow-y: auto; height: auto;">
                                                            <div class="row">
                                                                <div class="col-md-12 popuptable">
                                                                    <h4 class="modal-title text-left inner_modal_body">Team Members</h4>
                                                                    <button type="button" class="close teamclose" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                    <table class="table custom-table teamMember_second inner_modal_body" >
                                                                        <thead>
                                                                            <tr>
                                                                                <th>S.No</th>
                                                                                <th>Name</th>
                                                                                <th>Select</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for employee in all_crews %}
                                                                            <tr>
                                                                                <td>{{forloop.counter}}</td>
                                                                                <td>{{employee}}</td>
                                                                                
                                                                                <td>
                                                                                    <input type="checkbox" name="selectedNames{{i.id}}" value="{{employee}}"
                                                                                    {%for i in crews%}
                                                                                    {% if i.employee_name == employee %} checked {% endif %}
                                                                                    {%endfor%} 
                                                                                    />
                                                                                </td>
                                                                            </tr>
                                                                            {% endfor %}
                                                                            
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
    
                                                            <div class="modal-footer teampopup">
                                                                <button type="button" class="btn text-white savechangesbtn " id="cheked_team{{ task.id }}" data-dismiss="modal">Save changes</button>
    
                                                            </div>
                                                        </div>
    
                                                        </div>
    
                                                    </div>
                                                </div>
                                                
                                            <script>
                                               $(document).ready(function () {
                                                    $('#dropdownMenuButton{{i.id}}').click(function () {
                                                        $('.attch{{i.id}}').show();
                                                    });
                                                    $('.modalbodydesk,.task_details_head').click(function () {
                                                            $('.attch{{task.id}}').hide();
                                                        });
                                                    $("#teamList_second{{i.id}}").click(function(){
                                                        $('.attch{{task.id}}').hide();
                                                    });

                                                });
                                            </script>
                                            <script>
                                                $(document).ready(function(){
                                                    $(".popup_icons_user").click(function(){
                                                        $(this).css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                    });
                                                    $("#cheked_team{{ task.id }}, .teamclose, .inner_modal").click(function(){
                                                        $(".popup_icons_user").css({"border-bottom":"none","width":"auto","border-radius":"none","background":"none","color":"black"});
                                                    });
                                                    $(".inner_modal_body").click(function(event){
                                                        event.stopPropagation();
                                                        $(".popup_icons_user").css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                    });
                                                });
                                            </script>
                                            <script>
                                                $(document).ready(function(){
                                                    $("#chat_chat_details{{task.id}}").hide();
                                                    $("#chat_icon{{task.id}}").click(function(){
                                                        $(".completechat_first{{task.id}}").show();
                                                        $("#chat_chat_details{{task.id}}").hide();
                                                    });
                                                    $("#log_icon{{task.id}}").click(function(){
                                                        $("#chat_chat_details{{task.id}}").show();
                                                        $(".completechat_first{{task.id}}").hide();
                                                    });
                                                });
                                            </script>
                                            <script>
                                               $(document).ready(function(){
                                                    $(".horizontal_sec").hide();
                                                    $("#chat_icon{{task.id}}").click(function(){
                                                        $(".horizontal_fir").show();
                                                        $(".horizontal_sec").hide();
                                                    });
                                                    $("#log_icon{{task.id}}").click(function(){
                                                        $(".horizontal_fir").hide();
                                                        $(".horizontal_sec").show();
                                                    });
                                                });
                                            </script>
                                            <script>
                                                $(document).ready(function() {
                                                    $("#cheked_team{{ task.id }}").on("click", function() {
                                                        var selectedNames = [];
                                                        var csrftoken = getCookie('csrftoken');
                                                        $("input[name='selectedNames{{task.id}}']:checked").each(function() {
                                                            selectedNames.push($(this).val());
                                                        });
                                                        console.log(selectedNames);
                                                        // Perform AJAX request
                                                        $.ajax({
                                                            url: "../clientmanager/change_task_crew",
                                                            type: "POST",
                                                            data: { selectedNames: selectedNames,
                                                                    task_id: {{task.id}},
                                                                    csrfmiddlewaretoken: getCookie('csrftoken'),
                                                            },
                                                            success: function(response) {
                                                                console.log(response);

                                                            $("#tablemodal{{task.id}}").hide();

                                                            },
                                                            error: function(xhr, status, error) {
                                                                // Handle error
                                                                console.error(xhr.responseText);
                                                            }
                                                        });


                                                    });
                                                });
                                                function getCookie(name) {
                                                    var cookieValue = null;
                                                    if (document.cookie && document.cookie !== '') {
                                                        var cookies = document.cookie.split(';');
                                                        for (var i = 0; i < cookies.length; i++) {
                                                            var cookie = cookies[i].trim();
                                                            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                break;
                                                            }
                                                        }
                                                    }
                                                    return cookieValue;
                                                }
                                            </script>

                                            <script>
                                                $(document).on('click', '#first_heading{{i.id}}', function (e) {
                                                    e.preventDefault();
                                                    var flag = 0;
                                                    console.log(flag);
                                                    var buttonValue = {{ task.id }};
                                                    var csrftoken = getCookie('csrftoken');
                                                    console.log(buttonValue);
                                                    sendReq(buttonValue, flag)

                                                    var Interval = setInterval(function () { sendReq(buttonValue, 1); }, 750);
                                                    $('.stopInterval').on('click', () => {
                                                        clearInterval(Interval);
                                                    });
                                                    function sendReq(buttonValue, flag) {
                                                    $.ajax({
                                                        type: 'POST',
                                                        url: '../clientmanager/task_chat_refresh',
                                                        data: {
                                                            task_id: buttonValue,
                                                            csrfmiddlewaretoken: getCookie('csrftoken'),
                                                        },
                                                        success: function (x) {
                                                            for (var i = 0; i < x.data.length; i++) {
                                                                var show_data = `
                                                                                <div class="row">
                                                                                <div class="profCont team-chat" >
                                                                                    <img class="profile" src="../static/img/profiles/img-2.jpg">
                                                                                <div class="txt2">
                                                                                    <div class="row commentername" >
                                                                                        <div class="col-md-12 ">
                                                                                            <p> ${x.name} </p>
                                                                                        </div>
                                                                                    </div>
                                                                                    ${x.data}</div>
                                                                                </div>
                                                                                </div>`;
                                                                $("#notificationdetails" + buttonValue).append(show_data);
                                                                $("#notificationdetails_inner" + buttonValue).append(show_data);
                                                                console.log(flag);
                                                                console.log("flag");
                                                            }
                                                            console.log(flag);
                                                            if (flag == 0) {
                                                                var modalEmail = $("#modalEmail_inner_first" + buttonValue);
                                                                modalEmail.scrollTop(modalEmail.prop("scrollHeight"));
                                                                console.log(buttonValue);
                                                            }
                                                        }

                                                    });
                                                }
                                                });
                                                function getCookie(name) {
                                                    var cookieValue = null;
                                                    if (document.cookie && document.cookie !== '') {
                                                        var cookies = document.cookie.split(';');
                                                        for (var i = 0; i < cookies.length; i++) {
                                                            var cookie = cookies[i].trim();
                                                            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                break;
                                                            }
                                                        }
                                                    }
                                                    return cookieValue;
                                                }
                                            </script>
                                            
                                                {% endfor %}
                                            </div>
                                        </div>
                                </td>
<!-- -----------------------------------------------------------------first card end---------------------------------------------------------------------------------- -->



                                <td>
                                    <div class="row">
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                            <div class="card2 dash-widget ctm-border-radius shadow-sm grow "
                                                id="right1">
                                                {% for i,count,logs,task_chat,task_crew,task,crews,chats,task_logs,attachments,all_crews in development %}
                                                <div class="card-body cardinfo" draggable="true" id="{{i.id}}"
                                                    ondragstart="drag(event)">
                                                    <div class="card-right2">
                                                        <div class="card dash-widget ctm-border-radius shadow-sm grow2">
                                                            <div class="card-body innercardbody" style="padding: 10px;">
                                                                <!-- <p class="fontfamily" style="font-weight: bolder ;font-size: larger;" >{{i.task_heading}} : </p>
                                                                <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Phase {{i.phase}} </p>
                                                                <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Version : V{{i.project_version}} </p>
                                                                <p class="fontfamily">{{i.description}}</p> -->
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <h4 class="text-left chat_refresh_list " style="font-weight: bolder ;" id="middle_heading{{i.id}}" data-toggle="modal" data-target=".taskModal_middle{{i.id}}">{{i.task_heading}} </h4>
                                                                    </div>
                                                                    <!-- <div class="col-md-5 text-right">
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Phase {{i.phase}}  </p>
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Version : V{{i.project_version}} </p>
                                                                        <p class="" style="font-weight: bolder ;text-align: right; font-size: 12px;" >Priority : {{i.priority}} </p>
                                                                    </div> -->
                                                                </div>
                                                                <p class="fontfamily task_description" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-height: 19px;" title="{{i.description|safe}}" data-toggle="modal" data-target=".taskModal_middle{{i.id}}">{{i.description|safe}}</p>

                                                            </div>

                                                            <div class="row lowest">
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Requirement Date">
                                                                        {{i.assigning_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Target Date">
                                                                        {{i.target_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <p class="datefamily" title="Completed Date">
                                                                        {{i.complete_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <button value="{{i.id}}"
                                                                        class=" Modal2{{forloop.counter}} comment_button tasks_chat bubble lnr lnr-bubble mr-2"
                                                                        title="Comments"></button>
                                                                        {% if task_chat|length > 0 %}
                                                                        <div class="dot-circle"></div>
                                                                        {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class="row lowest">
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.database|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        title="Database Integration ({{i.database}})" class="hori"
                                                                        onclick="openPopup1()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.ui|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        title="UI Integration ({{i.ui}})" class="hori"
                                                                        onclick="openPopup2()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.backend|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        title="Backend Integration ({{i.backend}})" class="hori"
                                                                        onclick="openPopup3()">
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p class="count" title="Task ID (Rework Count)"
                                                                        data-toggle="modal"
                                                                        data-target="#add_Comment_event_second{{i.id}}">
                                                                        {{i.projec_task_id}} ({{count}})</p>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal fade" id="emailModal2{{forloop.counter}}"
                                                    tabindex="-1" aria-labelledby="exampleModalLabel"
                                                    aria-hidden="true">
                                                    <div class="modal-dialog modal_dialog">
                                                        <div class="modal-content commentbox">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">
                                                                    <b>Comments</b>
                                                                </h5>
                                                                <button type="button" class="close" data-dismiss="modal"
                                                                    aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body" id="modalEmail{{i.id}}">
                                                                <div class="notification-details"
                                                                    id="notificationdetails{{i.id}}">

                                                                    {% for chat in chats %}
                                                                                        {% if chat.user_name == request.session.name %}
                                                                                        <div class="row">
                                                                                            <div class="profCont5 my-chat">
                                                                                                <img class="profile5"
                                                                                                    src="../{{request.session.profile_pic}}">
                                                                                                <div class="txt5">
                                                                                                    <div class="row mycomment">
                                                                                                        <div class="col-md-12">
                                                                                                            {{chat.user_name}}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                        {% else %}

                                                                                        <div class="row">
                                                                                            <div class="profCont team-chat">
                                                                                                <img class="profile"
                                                                                                    src="../static/img/profiles/img-2.jpg">
                                                                                                <div class="txt2">
                                                                                                    <div class="row commentername">
                                                                                                        <div class="col-md-12 ">
                                                                                                            <p> {{chat.user_name}}</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}

                                                                                    {% endfor %}
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <label for="comnt" style="font-weight: 600;"></label>
                                                                <textarea name="commentsemphr" class="empty"
                                                                    id="comnt{{i.id}}" cols="10" rows="2"
                                                                    placeholder="Write Your Comments here...."></textarea>
                                                                <button name="chat_send" id="addEmpcomnt"
                                                                    value="{{i.id}}"
                                                                    class="chat_send btn btn-theme button-1 text-white ctm-border-radius mt-1">Send</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="add_Comment_event_second{{i.id}}" class="modal fade"
                                                    role="dialog">
                                                    <div class="modal-dialog modal-dialog-centered modal_dialog" role="document"
                                                        style="max-width: 850px;">
                                                        <div class="modal-content datauses">
                                                            <div class="modal-header">
                                                                <h4 class="modal-title">Status Log</h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="employee-office-table"
                                                                    style="box-shadow: none;">
                                                                    <div class="table-responsive">
                                                                        <table class="table custom-table table-hover">
                                                                            <thead id="checkmove">
                                                                                <tr class="statics">
                                                                                    <th>Sr.No.</th>
                                                                                    <th>From</th>
                                                                                    <th>To</th>
                                                                                    <th>Performed By</th>
                                                                                    <th>Date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody style="position: relative;">
                                                                                {% for k in logs %}
                                                                                <tr>
                                                                                    <td>{{forloop.counter}}</td>
                                                                                    <td>{{k.from_status}}</td>
                                                                                    <td>{{k.to_status}}</td>
                                                                                    <td>{{k.name}}</td>
                                                                                    <td>{{k.dates}}</td>

                                                                                </tr>
                                                                                {% endfor %}

                                                                            </tbody>
                                                                        </table>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer text-center">
                                                                <div class="row">
                                                                    <button name="cancelEmp"
                                                                        class="btn btn-danger text-white ctm-border-radius checkmovebtn"
                                                                        data-dismiss="modal"
                                                                        aria-label="Close">Cancel</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <script>
                                                    $(document).ready(function () {
                                                        $(".Modal2{{forloop.counter}}").click(function () {
                                                            $('#emailModal2{{forloop.counter}}').modal('show');
                                                        });
                                                    });
                                                </script>

                                                <div class="modal fade deskmodal taskModal_middle{{i.id}}" id="taskModal_middle{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-lg modal-dialog-centered dialogdesk chat_dialog" role="document">
                                                        <div class="modal-content contentdesk">
                                                            <div class="modal-header" style="padding: 0.5rem 1rem;">
                                                                <div class="row w-100 align-items-center">
                                                                    <div class="col-md-9 col-sm-7 task_details_head">
                                                                        <h4 class="modal-title text-left">Task Details</h4>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2  text-right">
                                                                        <div class="lnr lnr-paperclip popup_icons_attach" id="dropdownMenuButton{{task.id}}"></div>
                                                                            <div class="dropdown-menu attch{{task.id}} all_items" aria-labelledby="dropdownMenuButton{{task.id}}">
                                                                                <ul>
                                                                                {% for file in attachments %}
                                                                                <li class="file_name_images text-left" title="{{file.file_name}}">
                                                                                    <a style="color: black; padding: 10px;" href="/static/uploads/task_files/{{ i.file_name }}" target="_blank">
                                                                                        {% if file.file_name|lower|slice:'-4:' == '.pdf' %}
                                                                                            <img src="../static/img/pdf_icon.png" alt="PDF Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.doc' or file.file_name|lower|slice:'-5:' == '.docx' %}
                                                                                            <img src="../static/img/doc-icon.png" alt="Word Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.xls' or file.file_name|lower|slice:'-5:' == '.xlsx' %}
                                                                                            <img src="../static/img/xls_icon.png" alt="Excel Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.jpg' or file.file_name|lower|slice:'-5:' == '.jpeg' or file.file_name|lower|slice:'-4:' == '.png' %}
                                                                                            <img src="../static/img/jpg_icon.png" alt="Image Icon" width="20" height="20">
                                                                                        {% else %}
                                                                                            <img src="../static/img/Default_icon.png" alt="Default Icon" width="20" height="20">
                                                                                        {% endif %}
                                                                                        {{ file.file_name }} 
                                                                                    </a>
                                                                                </li>
                                                                                {% endfor %}
                                                                                    <!-- <li>Andrew</li>
                                                                                    <li>Roy</li>
                                                                                    <li>Sam</li>
                                                                                    <li>Johnson</li>
                                                                                    <li>Ponting</li>
                                                                                    <li>Ricky</li> -->

                                                                                </ul>
                                                                            </div>

                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2  text-right">
                                                                        <div class="lnr lnr-users teamList_second popup_icons_user" id="teamList_second{{i.id}}"
                                                                        data-toggle="modal"  data-target="#tablemodal{{i.id}}"></div>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-1  text-right">
                                                                        <button type="button" id="close_chat{{task.id}}" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-body modalbodydesk" style="height: 540px; overflow-y: hidden; padding-top: 0px;">
                                                                <div class="row">
                                                                    <div class="col-md-8 col-sm-8">
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                                <div class="largerdis">
                                                                                    <h5 class="text-left">{{task.task_heading}}</h5>
                                                                                    <p class="text-left">
                                                                                    {{task.description|safe}}
                                                                                    </p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mainicons">
                                                                            <div class="col-md-1 col-sm-2 icons">
                                                                                <img src="../static/img/double-chat-icon.svg" class="chat_icon" id="chat_icon_sec{{task.id}}" value="task.id" alt="Icon Description">
                                                                                <hr class="horizontal_fir">
                                                                            </div>
                                                                            <div class="col-md-1 col-sm-2 icons">
                                                                                <img src="../static/img/file-log-color-red-icon.svg" class="log_icon" id="log_icon_sec{{task.id}}" alt="Icon Description">
                                                                                <hr class="horizontal_sec text-left">
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                            <div class="card text-center completechat_sec{{task.id}}" id="completechat_sec{{task.id}}">
                                                                                    <div class="card-body chat_classs" id="modalEmail_inner_sec{{task.id}}">
                                                                                        <div class="notification-details"
                                                                                        id="notificationdetails_inner{{task.id}}">
                                                                                        {% for chat in chats %}
                                                                                        {% if chat.user_name == request.session.name %}
                                                                                        <div class="row">
                                                                                            <div class="profCont5 my-chat">
                                                                                                <img class="profile5"
                                                                                                    src="../{{request.session.profile_pic}}">
                                                                                                <div class="txt5">
                                                                                                    <div class="row mycomment">
                                                                                                        <div class="col-md-12">
                                                                                                            {{chat.user_name}}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                        {% else %}

                                                                                        <div class="row">
                                                                                            <div class="profCont team-chat">
                                                                                                <img class="profile"
                                                                                                    src="../static/img/profiles/img-2.jpg">
                                                                                                <div class="txt2">
                                                                                                    <div class="row commentername">
                                                                                                        <div class="col-md-12 ">
                                                                                                            <p> {{chat.user_name}}</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}

                                                                                    {% endfor %}
                                                                                    </div>
                                                                                    </div>
                                                                                    <div class="card-footer">
                                                                                        <label for="comnt" style="font-weight: 600; display: none;"></label>
                                                                                        <textarea name="commentsemphr" class="empty"
                                                                                            id="comnt_inner{{task.id}}" cols="10" rows="2"
                                                                                            placeholder="Write Your Comments here...."></textarea>
                                                                                        <button name="chat_send" id="chat_send_inner{{ task.id }}"
                                                                                            value="{{task.id}}"
                                                                                            class="chat_send_inner btn btn-theme button-1 text-white ctm-border-radius mt-3">
                                                                                            <img src="../static/img/send-paper-svgrepo-com.svg" alt="Send" class="send_image">
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="card chat_chat_details" id="chat_chat_details_sec{{task.id}}">

                                                                                    <div class="card-body chat_details">
                                                                                        <div class="employee-office-table"
                                                                                        style="box-shadow: none;">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table custom-table table-hover log_table">
                                                                                                <thead id="checkmove">
                                                                                                    <tr class="statics">
                                                                                                        <th>Sr.No.</th>
                                                                                                        <th>From</th>
                                                                                                        <th>To</th>
                                                                                                        <th>Performed By</th>
                                                                                                        <th>Date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody style="position: relative;">
                                                                                                    {% for log in task_logs %}
                                                                                                    <tr>
                                                                                                        <td>{{forloop.counter}}</td>
                                                                                                        <td>{{log.from_status}}</td>
                                                                                                        <td>{{log.to_status}}</td>
                                                                                                        <td>{{log.name}}</td>
                                                                                                        <td>{{log.dates}}</td>
                                                                                                    </tr>
                                                                                                    {% endfor %}

                                                                                                </tbody>
                                                                                            </table>

                                                                                        </div>
                                                                                    </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4 col-sm-4">
                                                                        <div class="showdatas">
                                                                            <div class="card inner_list" style="width: auto;">
                                                                                <ul class="list-group list-group-flush text-left">
                                                                                <li class="list-group-item">Assignee: {{task.assignee}}</li>
                                                                                <li class="list-group-item">Phase: Phase {{task.phase}}</li>
                                                                                <li class="list-group-item">Versio: v{{task.project_version}}</li>
                                                                                <li class="list-group-item">Priority:{{task.priority}}</li>
                                                                                <select class="list-group-item status_dropdown">

                                                                                    <option {% if task.status == 'Task List' %} selected {% endif %}
                                                                                        {% if task.status == 'pending' %} selected {% endif %}
                                                                                        value="{{task.id}}/Task List">Status: Task</option>
                                                                                    <option {% if task.status == 'Development' %} selected {% endif %}
                                                                                        {% if task.status == 'development' %} selected {% endif %}
                                                                                        value="{{task.id}}/Development">Status: Development</option>
                                                                                    <option {% if task.status == 'Completed' %} selected {% endif %}
                                                                                        {% if task.status == 'completed' %} selected {% endif %}
                                                                                        value="{{task.id}}/Completed">Status: Completed</option>

                                                                                </select>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="modal fade deskmodal inner_modal" id="tablemodal{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                <!-- <div class="modal  tableModalcheck" id="tablemodal{{i.id}}" tabindex="-1" role="dialog"> -->
                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content teamMemberModal">

                                                        <div class="modal-body teampopup" style="overflow-y: auto; height: auto;">
                                                            <div class="row">

                                                                <div class="col-md-12 popuptable">
                                                                    <h4 class="modal-title text-left inner_modal_body">Team Members</h4>
                                                            <button type="button" class="close teamclose" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                            </button>
                                                                    <table class="table custom-table teamMember_second inner_modal_body">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>S.No</th>
                                                                                <th>Name</th>

                                                                                <th>Select</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for employee in all_crews %}
                                                                            <tr>
                                                                                <td>{{forloop.counter}}</td>
                                                                                <td>{{employee}}</td>
                                                                                
                                                                                <td>
                                                                                    <input type="checkbox" name="selectedNames{{i.id}}" value="{{employee}}"
                                                                                    
                                                                                    {%for i in crews%}
                                                                                    {% if i.employee_name == employee %} checked {% endif %}
                                                                                    {%endfor%} 
                                                                                    />
                                                                                </td>
                                                                            </tr>
                                                                            {% endfor %}


                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>

                                                            <div class="modal-footer teampopup">
                                                                <button type="button" class="btn text-white savechangesbtn " id="cheked_team{{ task.id }}" data-dismiss="modal">Save changes</button>

                                                            </div>
                                                        </div>

                                                        </div>

                                                    </div>
                                                </div>

                                                <script>
                                                    $(document).ready(function () {
                                                        $('#dropdownMenuButton{{i.id}}').click(function () {
                                                            $('.attch{{i.id}}').show();
                                                        });
                                                        $('.modalbodydesk,.task_details_head').click(function () {
                                                            $('.attch{{task.id}}').hide();
                                                        });
                                                        $("#teamList_second{{i.id}}").click(function(){
                                                            $('.attch{{task.id}}').hide();
                                                        });

                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $(".popup_icons_user").click(function(){
                                                            $(this).css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                        });
                                                        $("#cheked_team{{ task.id }}, .teamclose, .inner_modal").click(function(){
                                                            $(".popup_icons_user").css({"border-bottom":"none","width":"auto","border-radius":"none","background":"none","color":"black"});
                                                        });
                                                        $(".inner_modal_body").click(function(event){
                                                        event.stopPropagation();
                                                        $(".popup_icons_user").css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                    });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $("#chat_chat_details_sec{{task.id}}").hide();
                                                        $("#chat_icon_sec{{task.id}}").click(function(){
                                                            $(".completechat_sec{{task.id}}").show();
                                                            $("#chat_chat_details_sec{{task.id}}").hide();
                                                        });
                                                        $("#log_icon_sec{{task.id}}").click(function(){
                                                            $("#chat_chat_details_sec{{task.id}}").show();
                                                            $(".completechat_sec{{task.id}}").hide();
                                                        });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $(".horizontal_sec").hide();
                                                        $("#chat_icon_sec{{task.id}}").click(function(){
                                                            $(".horizontal_fir").show();
                                                            $(".horizontal_sec").hide();
                                                        });
                                                        $("#log_icon_sec{{task.id}}").click(function(){
                                                            $(".horizontal_fir").hide();
                                                            $(".horizontal_sec").show();
                                                        });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function() {
                                                        $("#cheked_team{{ task.id }}").on("click", function() {
                                                            var selectedNames = [];
                                                            var csrftoken = getCookie('csrftoken');
                                                            $("input[name='selectedNames{{task.id}}']:checked").each(function() {
                                                                selectedNames.push($(this).val());
                                                            });
                                                            console.log(selectedNames);
                                                            // Perform AJAX request
                                                            $.ajax({
                                                                url: "../clientmanager/change_task_crew",
                                                                type: "POST",
                                                                data: { selectedNames: selectedNames,
                                                                        task_id: {{task.id}},
                                                                        csrfmiddlewaretoken: getCookie('csrftoken'),
                                                                },
                                                                success: function(response) {
                                                                    console.log(response);

                                                                $("#tablemodal{{task.id}}").hide();

                                                                },
                                                                error: function(xhr, status, error) {
                                                                    // Handle error
                                                                    console.error(xhr.responseText);
                                                                }
                                                            });


                                                        });
                                                    });
                                                    function getCookie(name) {
                                                            var cookieValue = null;
                                                            if (document.cookie && document.cookie !== '') {
                                                                var cookies = document.cookie.split(';');
                                                                for (var i = 0; i < cookies.length; i++) {
                                                                    var cookie = cookies[i].trim();
                                                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                        break;
                                                                    }
                                                                }
                                                            }
                                                            return cookieValue;
                                                        }
                                                    </script>
                                                      
                                                    <script>
                                                        $(document).on('click', '#middle_heading{{i.id}}', function (e) {
                                                            e.preventDefault();
                                                            var flag = 0;
                                                            console.log(flag);
                                                            var buttonValue = {{ task.id }};
                                                            var csrftoken = getCookie('csrftoken');
                                                            console.log(buttonValue);
                                                            sendReq(buttonValue, flag)
        
                                                            var Interval = setInterval(function () { sendReq(buttonValue, 1); }, 750);
                                                            $('.stopInterval').on('click', () => {
                                                                clearInterval(Interval);
                                                            });
                                                            function sendReq(buttonValue, flag) {
                                                            $.ajax({
                                                                type: 'POST',
                                                                url: '../clientmanager/task_chat_refresh',
                                                                data: {
                                                                    task_id: buttonValue,
                                                                    csrfmiddlewaretoken: getCookie('csrftoken'),
                                                                },
                                                                success: function (x) {
                                                                    for (var i = 0; i < x.data.length; i++) {
                                                                        var show_data = `
                                                                                        <div class="row">
                                                                                        <div class="profCont team-chat" >
                                                                                            <img class="profile" src="../static/img/profiles/img-2.jpg">
                                                                                        <div class="txt2">
                                                                                            <div class="row commentername" >
                                                                                                <div class="col-md-12 ">
                                                                                                    <p> ${x.name} </p>
                                                                                                </div>
                                                                                            </div>
                                                                                            ${x.data}</div>
                                                                                        </div>
                                                                                        </div>`;
                                                                        $("#notificationdetails" + buttonValue).append(show_data);
                                                                        $("#notificationdetails_inner" + buttonValue).append(show_data);
                                                                        console.log(flag);
                                                                        console.log("flag");
                                                                    }
                                                                    console.log(flag);
                                                                    if (flag == 0) {
                                                                        var modalEmail = $("#modalEmail_inner_sec" + buttonValue);
                                                                        modalEmail.scrollTop(modalEmail.prop("scrollHeight"));
                                                                        console.log(buttonValue);
                                                                    }
                                                                }
        
                                                            });
                                                        }
                                                        });
                                                        function getCookie(name) {
                                                            var cookieValue = null;
                                                            if (document.cookie && document.cookie !== '') {
                                                                var cookies = document.cookie.split(';');
                                                                for (var i = 0; i < cookies.length; i++) {
                                                                    var cookie = cookies[i].trim();
                                                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                        break;
                                                                    }
                                                                }
                                                            }
                                                            return cookieValue;
                                                        }
                                                    </script>
                                                {% endfor %}
                                            </div>
                                        </div>
                                </td>
<!-- ---------------------------------------------------------------------------second card end----------------------------------------------------------------- -->


                                <td>
                                    <div class="row">
                                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
                                            <div class="card2 dash-widget ctm-border-radius shadow-sm grow " id="last1">
                                                {% for i,count,logs,task_chat,task_crew,task,crews,chats,task_logs,attachments,all_crews in completed %}
                                                <div class="card-body cardinfo" draggable="true" id="{{i.id}}"
                                                    ondragstart="drag(event)">
                                                    <div class="card-right2">
                                                        <div class="card dash-widget ctm-border-radius shadow-sm grow3">
                                                            <div class="card-body innercardbody" style="padding: 10px;">
                                                                <!-- <p class="fontfamily" style="font-weight: bolder ;font-size: larger;" >{{i.task_heading}} </p>
                                                                <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Phase {{i.phase}} </p>
                                                                <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Version : V{{i.project_version}} </p>
                                                                <p class="fontfamily">{{i.description}}</p> -->
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <h4 class="text-left chat_refresh_list" style="font-weight: bolder ;" id="last_heading{{i.id}}" data-toggle="modal" data-target=".taskModal_last{{i.id}}">{{i.task_heading}}</h4>
                                                                    </div>
                                                                    <!-- <div class="col-md-5 text-right">
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Phase {{i.phase}}  </p>
                                                                        <p class="fontfamily" style="font-weight: bolder ;text-align: right;" >Version : V{{i.project_version}}</p>
                                                                        <p class="" style="font-weight: bolder ;text-align: right; font-size: 12px;" >Priority : {{i.priority}} </p>
                                                                    </div> -->
                                                                </div>
                                                                <p class="fontfamily task_description" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-height: 19px;" title="{{i.description|safe}}" data-toggle="modal" data-target=".taskModal_last{{i.id}}">{{i.description|safe}}</p>
                                                            </div>

                                                            <div class="row lowest">
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Requirement Date">
                                                                        {{i.assigning_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard1">
                                                                    <p class="datefamily" title="Target Date">
                                                                        {{i.target_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <p class="datefamily" title="Completed Date">
                                                                        {{i.complete_date}}</p>
                                                                </div>
                                                                <div class="col-md-3 datecard2">
                                                                    <button value="{{i.id}}"
                                                                        class=" Modal3{{forloop.counter}} comment_button tasks_chat bubble lnr lnr-bubble mr-2"
                                                                        title="Comments"></button>
                                                                        {% if task_chat|length > 0 %}
                                                                        <div class="dot-circle"></div>
                                                                        {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class="row lowest">
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.database|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}

                                                                        title="Database Integration ({{i.database}})" class="hori"
                                                                        onclick="openPopup1()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.ui|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        title="UI Integration ({{i.ui}})" class="hori"
                                                                        onclick="openPopup2()">
                                                                </div>
                                                                <div class="col-md-3 cardhori">
                                                                    <hr {% if i.backend|length > 1 %}
                                                                        style="background-color: #007514;" {% endif %}
                                                                        title="Backend Integration ({{i.backend}})" class="hori"
                                                                        onclick="openPopup3()">
                                                                </div>
                                                                <div class="col-md-3">
                                                                    <p class="count" title="Task ID (Rework Count)"
                                                                        class="count" data-toggle="modal"
                                                                        data-target="#add_Comment_event_third{{i.id}}">
                                                                        {{i.projec_task_id}} ({{count}})</p>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal fade" id="emailModal3{{forloop.counter}}"
                                                    tabindex="-1" aria-labelledby="exampleModalLabel"
                                                    aria-hidden="true">
                                                    <div class="modal-dialog modal_dialog">
                                                        <div class="modal-content commentbox">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLabel">
                                                                    <b>Comments</b>
                                                                </h5>
                                                                <button type="button" class="close" data-dismiss="modal"
                                                                    aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body" id="modalEmail{{i.id}}">
                                                                <div class="notification-details "
                                                                    id="notificationdetails{{i.id}}">

                                                                    {% for chat in chats %}
                                                                                        {% if chat.user_name == request.session.name %}
                                                                                        <div class="row">
                                                                                            <div class="profCont5 my-chat">
                                                                                                <img class="profile5"
                                                                                                    src="../{{request.session.profile_pic}}">
                                                                                                <div class="txt5">
                                                                                                    <div class="row mycomment">
                                                                                                        <div class="col-md-12">
                                                                                                            {{chat.user_name}}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                        {% else %}

                                                                                        <div class="row">
                                                                                            <div class="profCont team-chat">
                                                                                                <img class="profile"
                                                                                                    src="../static/img/profiles/img-2.jpg">
                                                                                                <div class="txt2">
                                                                                                    <div class="row commentername">
                                                                                                        <div class="col-md-12 ">
                                                                                                            <p> {{chat.user_name}}</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}

                                                                                    {% endfor %}
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <label for="comnt" style="font-weight: 600;"></label>
                                                                <textarea name="commentsemphr" class="empty"
                                                                    id="comnt{{i.id}}" cols="10" rows="2"
                                                                    placeholder="Write Your Comments here...."></textarea>
                                                                <button name="chat_send" id="addEmpcomnt"
                                                                    value="{{i.id}}"
                                                                    class="chat_send btn btn-theme button-1 text-white ctm-border-radius mt-1">Send</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div id="add_Comment_event_third{{i.id}}" class="modal fade"
                                                    role="dialog">
                                                    <div class="modal-dialog modal-dialog-centered" role="document"
                                                        style="max-width: 850px;">
                                                        <div class="modal-content datauses">
                                                            <div class="modal-header">
                                                                <h4 class="modal-title">Status Log</h4>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="employee-office-table"
                                                                    style="box-shadow: none;">
                                                                    <div class="table-responsive">
                                                                        <table class="table custom-table table-hover">
                                                                            <thead id="checkmove">
                                                                                <tr class="statics">
                                                                                    <th>Sr.No.</th>
                                                                                    <th>From</th>
                                                                                    <th>To</th>
                                                                                    <th>Performed By</th>
                                                                                    <th>Date</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody style="position: relative;">
                                                                                {% for k in logs %}
                                                                                <tr>
                                                                                    <td>{{forloop.counter}}</td>
                                                                                    <td>{{k.from_status}}</td>
                                                                                    <td>{{k.to_status}}</td>
                                                                                    <td>{{k.name}}</td>
                                                                                    <td>{{k.dates}}</td>

                                                                                </tr>
                                                                                {% endfor %}

                                                                            </tbody>
                                                                        </table>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer text-center">
                                                                <div class="row">
                                                                    <button name="cancelEmp"
                                                                        class="btn btn-danger text-white ctm-border-radius checkmovebtn"
                                                                        data-dismiss="modal"
                                                                        aria-label="Close">Cancel</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <script>
                                                    $(document).ready(function () {
                                                        $(".Modal3{{forloop.counter}}").click(function () {
                                                            $('#emailModal3{{forloop.counter}}').modal('show');
                                                        });
                                                    });
                                                </script>

                                                <div class="modal fade deskmodal taskModal_last{{i.id}}" id="taskModal_last{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-lg modal-dialog-centered dialogdesk chat_dialog" role="document">
                                                        <div class="modal-content contentdesk">
                                                            <div class="modal-header" style="padding: 0.5rem 1rem;">
                                                                <div class="row w-100 align-items-center">
                                                                    <div class="col-md-9 col-sm-7 task_details_head">
                                                                        <h4 class="modal-title text-left">Task Details</h4>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2 text-right">
                                                                        <div class="lnr lnr-paperclip popup_icons_attach" id="dropdownMenuButton{{task.id}}"></div>
                                                                            <div class="dropdown-menu attch{{task.id}} all_items" aria-labelledby="dropdownMenuButton{{task.id}}">
                                                                                <ul>
                                                                                {% for file in attachments %}
                                                                                <li class="file_name_images text-left" title="{{file.file_name}}">
                                                                                    <a style="color: black; padding: 10px;" href="/static/uploads/task_files/{{ i.file_name }}" target="_blank">
                                                                                        {% if file.file_name|lower|slice:'-4:' == '.pdf' %}
                                                                                            <img src="../static/img/pdf_icon.png" alt="PDF Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.doc' or file.file_name|lower|slice:'-5:' == '.docx' %}
                                                                                            <img src="../static/img/doc-icon.png" alt="Word Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.xls' or file.file_name|lower|slice:'-5:' == '.xlsx' %}
                                                                                            <img src="../static/img/xls_icon.png" alt="Excel Icon" width="20" height="20">
                                                                                        {% elif file.file_name|lower|slice:'-4:' == '.jpg' or file.file_name|lower|slice:'-5:' == '.jpeg' or file.file_name|lower|slice:'-4:' == '.png' %}
                                                                                            <img src="../static/img/jpg_icon.png" alt="Image Icon" width="20" height="20">
                                                                                        {% else %}
                                                                                            <img src="../static/img/Default_icon.png" alt="Default Icon" width="20" height="20">
                                                                                        {% endif %}
                                                                                        {{ file.file_name }} 
                                                                                    </a>
                                                                                </li>
                                                                                {% endfor %}
                                                                                    <!-- <li>Andrew</li>
                                                                                    <li>Roy</li>
                                                                                    <li>Sam</li>
                                                                                    <li>Johnson</li>
                                                                                    <li>Ponting</li>
                                                                                    <li>Ricky</li> -->

                                                                                </ul>
                                                                            </div>

                                                                    </div>
                                                                    <div class="col-md-1 col-sm-2  text-right">
                                                                        <div class="lnr lnr-users teamList_second popup_icons_user" id="teamList_second{{i.id}}"
                                                                        data-toggle="modal"  data-target="#tablemodal{{i.id}}"></div>
                                                                    </div>
                                                                    <div class="col-md-1 col-sm-1 text-right">
                                                                        <button type="button" id="close_chat{{task.id}}" class="close" data-dismiss="modal" aria-label="Close">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-body modalbodydesk" style="height: 540px; overflow-y: hidden; padding-top: 0px;">
                                                                <div class="row">
                                                                    <div class="col-md-8 col-sm-8">
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                                <div class="largerdis">
                                                                                    <h5 class="text-left">{{task.task_heading}}</h5>
                                                                                    <p class="text-left">
                                                                                    {{task.description|safe}}
                                                                                    </p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mainicons">
                                                                            <div class="col-md-1 col-sm-2 icons">
                                                                                <img src="../static/img/double-chat-icon.svg" class="chat_icon" id="chat_icon_last{{task.id}}" value="task.id" alt="Icon Description">
                                                                                <hr class="horizontal_fir">
                                                                            </div>
                                                                            <div class="col-md-1 col-sm-2 icons">
                                                                                <img src="../static/img/file-log-color-red-icon.svg" class="log_icon" id="log_icon_last{{task.id}}" alt="Icon Description">
                                                                                <hr class="horizontal_sec text-left">
                                                                            </div>
                                                                        </div>
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                            <div class="card text-center completechat_last{{task.id}}" id="completechat_last{{task.id}}">
                                                                                    <div class="card-body chat_classs" id="modalEmail_inner_last{{task.id}}">
                                                                                        <div class="notification-details"
                                                                                        id="notificationdetails_inner{{task.id}}">
                                                                                        {% for chat in chats %}
                                                                                        {% if chat.user_name == request.session.name %}
                                                                                        <div class="row">
                                                                                            <div class="profCont5 my-chat">
                                                                                                <img class="profile5"
                                                                                                    src="../{{request.session.profile_pic}}">
                                                                                                <div class="txt5">
                                                                                                    <div class="row mycomment">
                                                                                                        <div class="col-md-12">
                                                                                                            {{chat.user_name}}
                                                                                                        </div>
                                                                                                    </div>
                                                                                                {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                        {% else %}

                                                                                        <div class="row">
                                                                                            <div class="profCont team-chat">
                                                                                                <img class="profile"
                                                                                                    src="../static/img/profiles/img-2.jpg">
                                                                                                <div class="txt2">
                                                                                                    <div class="row commentername">
                                                                                                        <div class="col-md-12 ">
                                                                                                            <p> {{chat.user_name}}</p>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    {{chat.description}}
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        {% endif %}

                                                                                    {% endfor %}
                                                                                    </div>
                                                                                    </div>
                                                                                    <div class="card-footer">
                                                                                        <label for="comnt" style="font-weight: 600; display: none;"></label>
                                                                                        <textarea name="commentsemphr" class="empty"
                                                                                            id="comnt_inner{{task.id}}" cols="10" rows="2"
                                                                                            placeholder="Write Your Comments here...."></textarea>
                                                                                        <button name="chat_send" id="chat_send_inner{{ task.id }}"
                                                                                            value="{{task.id}}"
                                                                                            class="chat_send_inner btn btn-theme button-1 text-white ctm-border-radius mt-3">
                                                                                            <img src="../static/img/send-paper-svgrepo-com.svg" alt="Send" class="send_image">
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="card chat_chat_details" id="chat_chat_details_last{{task.id}}">

                                                                                    <div class="card-body chat_details">
                                                                                        <div class="employee-office-table"
                                                                                        style="box-shadow: none;">
                                                                                        <div class="table-responsive">
                                                                                            <table class="table custom-table table-hover log_table">
                                                                                                <thead id="checkmove">
                                                                                                    <tr class="statics">
                                                                                                        <th>Sr.No.</th>
                                                                                                        <th>From</th>
                                                                                                        <th>To</th>
                                                                                                        <th>Performed By</th>
                                                                                                        <th>Date</th>
                                                                                                    </tr>
                                                                                                </thead>
                                                                                                <tbody style="position: relative;">
                                                                                                    {% for log in task_logs %}
                                                                                                    <tr>
                                                                                                        <td>{{forloop.counter}}</td>
                                                                                                        <td>{{log.from_status}}</td>
                                                                                                        <td>{{log.to_status}}</td>
                                                                                                        <td>{{log.name}}</td>
                                                                                                        <td>{{log.dates}}</td>
                                                                                                    </tr>
                                                                                                    {% endfor %}

                                                                                                </tbody>
                                                                                            </table>

                                                                                        </div>
                                                                                    </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4 col-sm-4">
                                                                        <div class="showdatas">
                                                                            <div class="card inner_list" style="width: auto;">
                                                                                <ul class="list-group list-group-flush text-left">
                                                                                <li class="list-group-item">Assignee: {{task.assignee}}</li>
                                                                                <li class="list-group-item">Phase: Phase {{task.phase}}</li>
                                                                                <li class="list-group-item">Versio: v{{task.project_version}}</li>
                                                                                <li class="list-group-item">Priority:{{task.priority}}</li>
                                                                                <select class="list-group-item status_dropdown">

                                                                                    <option {% if task.status == 'Task List' %} selected {% endif %}
                                                                                        {% if task.status == 'pending' %} selected {% endif %}
                                                                                        value="{{task.id}}/Task List">Status: Task</option>
                                                                                    <option {% if task.status == 'Development' %} selected {% endif %}
                                                                                        {% if task.status == 'development' %} selected {% endif %}
                                                                                        value="{{task.id}}/Development">Status: Development</option>
                                                                                    <option {% if task.status == 'Completed' %} selected {% endif %}
                                                                                        {% if task.status == 'completed' %} selected {% endif %}
                                                                                        value="{{task.id}}/Completed">Status: Completed</option>

                                                                                </select>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="modal fade deskmodal inner_modal" id="tablemodal{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="taskModalLabel" aria-hidden="true">
                                                <!-- <div class="modal  tableModalcheck" id="tablemodal{{i.id}}" tabindex="-1" role="dialog"> -->

                                                    <div class="modal-dialog" role="document">
                                                        <div class="modal-content teamMemberModal">

                                                        <div class="modal-body teampopup" style="overflow-y: auto; height: auto;">
                                                            <div class="row">

                                                                <div class="col-md-12 popuptable">
                                                                    <h4 class="modal-title text-left inner_modal_body">Team Members</h4>
                                                            <button type="button" class="close teamclose" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                            </button>
                                                                    <table class="table custom-table teamMember_second inner_modal_body">
                                                                        <thead>
                                                                            <tr>
                                                                                <th>S.No</th>
                                                                                <th>Name</th>

                                                                                <th>Select</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            {% for employee in all_crews %}
                                                                            <tr>
                                                                                <td>{{forloop.counter}}</td>
                                                                                <td>{{employee}}</td>
                                                                                
                                                                                <td>
                                                                                    <input type="checkbox" name="selectedNames{{i.id}}" value="{{employee}}"
                                                                                    
                                                                                    {%for i in crews%}
                                                                                    {% if i.employee_name == employee %} checked {% endif %}
                                                                                    {%endfor%} 
                                                                                    />
                                                                                </td>
                                                                            </tr>
                                                                            {% endfor %}


                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>

                                                            <div class="modal-footer teampopup">
                                                                <button type="button" class="btn text-white savechangesbtn " id="cheked_team{{ task.id }}" data-dismiss="modal">Save changes</button>

                                                            </div>
                                                        </div>

                                                        </div>

                                                    </div>
                                                </div>

                                                <script>
                                                    $(document).ready(function () {
                                                        $('#dropdownMenuButton{{i.id}}').click(function () {
                                                            $('.attch{{i.id}}').show();
                                                        });
                                                        $('.modalbodydesk,.task_details_head').click(function () {
                                                            $('.attch{{task.id}}').hide();
                                                        });
                                                        $("#teamList_second{{i.id}}").click(function(){
                                                            $('.attch{{task.id}}').hide();
                                                        });

                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $(".popup_icons_user").click(function(){
                                                            $(this).css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                        });
                                                        $("#cheked_team{{ task.id }}, .teamclose, .inner_modal").click(function(){
                                                            $(".popup_icons_user").css({"border-bottom":"none","width":"auto","border-radius":"none","background":"none","color":"black"});
                                                        });
                                                        $(".inner_modal_body").click(function(event){
                                                        event.stopPropagation();
                                                        $(".popup_icons_user").css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                    });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $("#chat_chat_details_last{{task.id}}").hide();
                                                        $("#chat_icon_last{{task.id}}").click(function(){
                                                            $(".completechat_last{{task.id}}").show();
                                                            $("#chat_chat_details_last{{task.id}}").hide();
                                                        });
                                                        $("#log_icon_last{{task.id}}").click(function(){
                                                            $("#chat_chat_details_last{{task.id}}").show();
                                                            $(".completechat_last{{task.id}}").hide();
                                                        });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function(){
                                                        $(".horizontal_sec").hide();
                                                        $("#chat_icon_last{{task.id}}").click(function(){
                                                            $(".horizontal_fir").show();
                                                            $(".horizontal_sec").hide();
                                                        });
                                                        $("#log_icon_last{{task.id}}").click(function(){
                                                            $(".horizontal_fir").hide();
                                                            $(".horizontal_sec").show();
                                                        });
                                                    });
                                                </script>
                                                <script>
                                                    $(document).ready(function() {
                                                        $("#cheked_team{{ task.id }}").on("click", function() {
                                                            var selectedNames = [];
                                                            var csrftoken = getCookie('csrftoken');
                                                            $("input[name='selectedNames{{task.id}}']:checked").each(function() {
                                                                selectedNames.push($(this).val());
                                                            });
                                                            console.log(selectedNames);
                                                            // Perform AJAX request
                                                            $.ajax({
                                                                url: "../clientmanager/change_task_crew",
                                                                type: "POST",
                                                                data: { selectedNames: selectedNames,
                                                                        task_id: {{task.id}},
                                                                        csrfmiddlewaretoken: getCookie('csrftoken'),
                                                                },
                                                                success: function(response) {
                                                                    console.log(response);

                                                                $("#tablemodal{{task.id}}").hide();

                                                                },
                                                                error: function(xhr, status, error) {
                                                                    // Handle error
                                                                    console.error(xhr.responseText);
                                                                }
                                                            });


                                                        });
                                                    });
                                                    function getCookie(name) {
                                                            var cookieValue = null;
                                                            if (document.cookie && document.cookie !== '') {
                                                                var cookies = document.cookie.split(';');
                                                                for (var i = 0; i < cookies.length; i++) {
                                                                    var cookie = cookies[i].trim();
                                                                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                        break;
                                                                    }
                                                                }
                                                            }
                                                            return cookieValue;
                                                        }
                                                    </script>

                                                <script>
                                                    $(document).on('click', '#last_heading{{i.id}}', function (e) {
                                                        e.preventDefault();
                                                        var flag = 0;
                                                        console.log(flag);
                                                        var buttonValue = {{ task.id }};
                                                        var csrftoken = getCookie('csrftoken');
                                                        console.log(buttonValue);
                                                        sendReq(buttonValue, flag)

                                                        var Interval = setInterval(function () { sendReq(buttonValue, 1); }, 750);
                                                        $('.stopInterval').on('click', () => {
                                                            clearInterval(Interval);
                                                        });
                                                        function sendReq(buttonValue, flag) {
                                                        $.ajax({
                                                            type: 'POST',
                                                            url: '../clientmanager/task_chat_refresh',
                                                            data: {
                                                                task_id: buttonValue,
                                                                csrfmiddlewaretoken: getCookie('csrftoken'),
                                                            },
                                                            success: function (x) {
                                                                for (var i = 0; i < x.data.length; i++) {
                                                                    var show_data = `
                                                                                    <div class="row">
                                                                                    <div class="profCont team-chat" >
                                                                                        <img class="profile" src="../static/img/profiles/img-2.jpg">
                                                                                    <div class="txt2">
                                                                                        <div class="row commentername" >
                                                                                            <div class="col-md-12 ">
                                                                                                <p> ${x.name} </p>
                                                                                            </div>
                                                                                        </div>
                                                                                        ${x.data}</div>
                                                                                    </div>
                                                                                    </div>`;
                                                                    $("#notificationdetails" + buttonValue).append(show_data);
                                                                    $("#notificationdetails_inner" + buttonValue).append(show_data);
                                                                    console.log(flag);
                                                                    console.log("flag");
                                                                }
                                                                console.log(flag);
                                                                if (flag == 0) {
                                                                    var modalEmail = $("#modalEmail_inner_last" + buttonValue);
                                                                    modalEmail.scrollTop(modalEmail.prop("scrollHeight"));
                                                                    console.log(buttonValue);
                                                                }
                                                            }

                                                        });
                                                    }
                                                    });
                                                    function getCookie(name) {
                                                        var cookieValue = null;
                                                        if (document.cookie && document.cookie !== '') {
                                                            var cookies = document.cookie.split(';');
                                                            for (var i = 0; i < cookies.length; i++) {
                                                                var cookie = cookies[i].trim();
                                                                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                                                                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                                                    break;
                                                                }
                                                            }
                                                        }
                                                        return cookieValue;
                                                    }
                                                </script>

                                                {% endfor %}

                                            </div>
                                        </div>
                                </td>

<!-- -------------------------------------------------------------------------------last card end---------------------------------------------------------------- -->



                            </tr>
                    </table>
                    <div class="TeamDiv">
                        <table class="table custom-table teamMember">
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th>Name</th>
                                    <th>Designation</th>
                                </tr>
                            </thead> 
                            <tbody>
                                {% for i in project_team %}
                                <tr>
                                    <td>{{forloop.counter}}</td>
                                    <td>{{i.employee_name}}</td>
                                    <td>{{i.designation}}</td>
                                </tr>
                                {% endfor %}
                            
                            </tbody>
                        </table>
                    </div>
                    <div id="add_event" class="modal fade" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 950px;">
                            <div class="modal-content addtask">
                                <div class="modal-header">
                                    <h5 class="modal-title">Add Task</h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body" style="overflow: auto;">
                                    <!-- <div class="employee-office-table" style="box-shadow: none;">
                                        <div class="table-responsive">
                                            <table class="table custom-table table-hover">
                                                <tbody>
                                                    <tr>
                                                        <th style="text-align: left;">Type<span class="text-danger">*</span></th>
                                                        <td>
                                                            <select id="" class="form-control" name="type" required>
                                                                <option value="New Task">New Task</option>
                                                                <option value="Bug">Bug</option>
                                                            </select>
                                                        </td>
                                                        <th style="text-align: left;">Task Heading<span class="text-danger">*</span></th>
                                                        <td>
                                                            <input id="" title="Task Heading" name="task_heading" autocomplete="off" type="text" required>
                                                        </td>
                                                    </tr>
                                                   
                                                    <tr>
                                                        <th style="text-align: left; display: initial;">Task Description
                                                            <span class="text-danger">*</span>
                                                        </th>
                                                    </tr>
                                                    <tr>
                                                        <td>
                                                            <textarea name="task" id="task" cols="1" rows="3"
                                                                title="Description About the task"
                                                                placeholder="Add Task Description..." required></textarea>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th style="text-align: left; display: initial;">Assign Task<span
                                                                class="text-danger">*</span></th>
                                                                <td>
                                                                    <select id="addEmployeeName" name="task_crew"
                                                                    class=" select" multiple >
                                                                    <option value="0">-Select-</option>
                                                                    {%for employee in employees%}
                                                                    <option value="{{employee.email}}">{{employee.f_name}}
                                                                        {{employee.l_name}}</option>
                                                                    {%endfor%}
                                                                </select>
                                                                </td>
                                                                <th style="text-align: left; display: initial;" >Priority<span
                                                                    class="text-danger">*</span></th>
                                                                    <td>
                                                                        <select id="" class="form-control" name="priority" required>
                                                                            <option value="0" >--Select--</option>
                                                                            <option value="Highest" id="">Highest</option>
                                                                            <option value="High" id="">High</option>
                                                                            <option value="Medium" id="">Medium</option>
                                                                            <option value="Low" id="">Low</option>
                                                                            <option value="Lowest" id="">Lowest</option>
                                                                        </select>
                                                                    </td>
                                                    </tr>

                                                    
                                                    
                                                    <tr>
                                                        <th style="text-align: left; display: initial;">Target Date<span
                                                                class="text-danger">*</span></th>
                                                                <td>
                                                                    <input id="taskdate" title="Add task Completion date"
                                                                        name="date" autocomplete="off" type="date" required></input>
                                                                </td>
                                                                <th style="text-align: left; display: initial;">Attachments</th>
                                                                <td>
                                                                    <input name="attachments" type="file" id="fileInput" multiple accept="*">
                                                                </td>
                                                    </tr>
                                                    
                                                </tbody>
                                            </table>

                                        </div>
                                    </div> -->
                                    
                                        <div class="employee-office-form">
                                            <div class="form-group row">
                                                <label for="type" class="col-sm-2 col-form-label"><b>Task Type</b><span class="text-danger">*</span></label>
                                                <div class="col-sm-4">
                                                    <select id="type" class="form-control" name="type" required>
                                                        <option value="New Task">New Task</option>
                                                        <option value="Bug">Bug</option>
                                                    </select>
                                                </div>
                                                <label for="task_heading" class="col-sm-2 col-form-label"><b>Task Title</b><span class="text-danger">*</span></label>
                                                <div class="col-sm-4">
                                                    <input id="task_heading" title="Task Heading" name="task_heading" autocomplete="off" type="text" class="form-control" required>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="task" class="col-form-label"><b>Task Description</b><span class="text-danger">*</span></label>
                                                <textarea name="task" id="task" cols="1" rows="3" title="Description About the task" class="form-control" placeholder="Add Task Description..." required></textarea>
                                            </div>
                                            <div class="form-group row">
                                                <label for="addEmployeeName" class="col-sm-2 col-form-label"><b>Assign To</b><span class="text-danger">*</span></label>
                                                <div class="col-sm-4">
                                                    <select id="addEmployeeName" name="task_crew" class="select form-control" multiple required>
                                                        <!-- <option value="0">-Select-</option> -->
                                                        
                                                        {% for employee in employees %}
                                                        <!-- {% if employee in project_team %} selected {%endif%} -->
                                                        <option {% if employee.email in project_team_task %} selected {%endif%}  value="{{employee.email}}"> {{employee.f_name}} {{employee.l_name}}</option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                                <label for="priority" class="col-sm-2 col-form-label"><b>Priority</b><span class="text-danger">*</span></label>
                                                <div class="col-sm-4">
                                                    <select id="priority" class="form-control" name="priority" required>
                                                        <option value="Medium">Medium</option>
                                                        <option value="Highest">Highest</option>
                                                        <option value="High">High</option>
                                                        <option value="Low">Low</option>
                                                        <option value="Lowest">Lowest</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group row">
                                                <label for="taskdate" class="col-sm-2 col-form-label"><b>Target Date</b><span class="text-danger">*</span></label>
                                                <div class="col-sm-4">
                                                    <input id="taskdate" title="Add task Completion date" name="date" autocomplete="off" type="date" class="form-control" required>
                                                </div>
                                                <label for="attachments" class="col-sm-2 col-form-label"><b>Attachments</b></label>
                                                <div class="col-sm-4">
                                                    <!-- <input name="attachments" type="file" id="fileInput" multiple accept="*"> -->
                                                    <input name="attachments" type="file" id="attachments" multiple accept="*" >
                                                </div>
                                            </div>
                                            
                                        </div>
                                   
                                    
                                    <!-- <div class="text-center">
                                        <button name="add_Task" id="addEmp"
                                            class="btn btn-theme button-1 text-white ctm-border-radius mt-4 taskbtn">Add</button>
                                        <button name="cancelEmp"
                                            class="btn btn-danger text-white ctm-border-radius mt-4 taskbtn"
                                            data-dismiss="modal" aria-label="Close">Cancel</button>
                                    </div> -->
                                </div>
                                <div class="modal-footer d-flex justify-content-center">
                                    <button name="add_Task" id="addEmp" class="btn btn-theme button-1 text-white ctm-border-radius mt-1 taskbtn">Add</button>
                                    <button name="cancelEmp" class="btn btn-danger text-white ctm-border-radius mt-1 taskbtn" data-dismiss="modal" aria-label="Close">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>
                <div class="popup-container" id="popup1">
                    <div class="popup-content">
                        <p>Databae Integration Completed</p>
                        <div class="row" style="margin-top: 15px;">
                            <div class="col-md-12">
                                <button onclick="closePopup1()"
                                    class="btn btn-theme button-1 text-white ctm-border-radius">Yes</button>
                                <button onclick="closePopup1()"
                                    class="btn btn-danger text-white ctm-border-radius">No</button>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="popup-container" id="popup2">
                    <div class="popup-content">
                        <p>UI Integration Completed</p>
                        <div class="row" style="margin-top: 15px;">
                            <div class="col-md-12">
                                <button onclick="closePopup2()"
                                    class="btn btn-theme button-1 text-white ctm-border-radius">Yes</button>
                                <button onclick="closePopup2()"
                                    class="btn btn-danger text-white ctm-border-radius">No</button>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="popup-container" id="popup3">
                    <div class="popup-content">
                        <p>Backend Integration Completed</p>
                        <div class="row" style="margin-top: 15px;">
                            <div class="col-md-12">
                                <button onclick="closePopup3()"
                                    class="btn btn-theme button-1 text-white ctm-border-radius">Yes</button>
                                <button onclick="closePopup3()"
                                    class="btn btn-danger text-white ctm-border-radius">No</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="../static/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js"></script>
<script>
    /* Custom Dragula JS */
    dragula([
        document.getElementById("left1"),
        document.getElementById("right1"),
        document.getElementById("last1"),
        // document.getElementById("trash")
    ])
        .on("drag", function (el) {
            el.className.replace("ex-moved", "");
        })
        .on("drop", function (el, target, source) {
            el.className += " ex-moved";
            var draggedElementId = el.id;
            var sourceContainerId = source.id;
            var targetContainerId = target.id;
            var csrftoken = getCookie('csrftoken');
            var urlName = window.location.href;
            console.log("Inner card ID: " + draggedElementId);
            console.log("From ID: " + sourceContainerId);
            console.log("To ID: " + targetContainerId);
            console.log("urlName: " + urlName);

            //   status_change(draggedElementId,sourceContainerId,targetContainerId)
            
            // alert('heloo')
            $.ajax({
                type: 'POST',
                url: '../clientmanager/status_change',
                data: {
                    urlName:urlName,
                    task_id: draggedElementId,
                    Fromvalues: sourceContainerId,
                    Tovalues: targetContainerId,
                    csrfmiddlewaretoken: csrftoken,
                },
                success: function (respnse) {
                    // alert('hello');
                }

            });

        })
        .on("over", function (el, container) {
            container.className += " ex-over";
        })
        .on("out", function (el, container) {
            container.className.replace("ex-over", "");
        });

    /* Function for drag start event */
    function drag(event) {
        event.dataTransfer.setData("text", event.target.id);
    }
</script>


<script>
    $(document).ready(function () {
        $(".bubble").click(function () {
            $('#emailModal').modal('show');
        });
    });
</script>
<script>
    $(document).ready(function () {
        $(".bubble").mouseenter(function () {
            $(this).css({ "color": "black", "cursor": "pointer" });
        });
        $(".bubble").mouseleave(function () {
            $(this).css({ "color": "white", "cursor": "pointer" });
        });
        $(".bubble").click(function () {
            $(this).css({ "color": "blue", "cursor": "pointer" });
        });

    });
</script>
<script>
    $(document).ready(function () {
        // $("vj1").hide();
        $("#fullscreen").click(function () {
            $("#sidebarid").hide();
            $(".dashboardbody").css({ "max-width": "100%", "flex": "0 0 100%" });
            $(this).hide();
            $("#showsidebar").show();
            $("#left1, #right1, #last1").css({ "width": "29vw" });
            $(".grow1,.grow2,.grow3").css({ "width": "26.2vw" });
            $("hr.hori").css({ "margin-left": "2vw" });
        });
    });
</script>

<script>
    $(document).ready(function () {
        $("#showsidebar").hide();
        $("#showsidebar").click(function () {
            $("#sidebarid").show();
            if($(window).width() > 991 && $(window).width() < 1200){
                $(".dashboardbody").css({ "max-width": "66%", "flex": "0 0 66%" });
                $("#left1, #right1, #last1").css({ "width": "18vw" });
                $(".grow1,.grow2,.grow3").css({ "width": "16.3vw" });
            }
            else{
                $(".dashboardbody").css({ "max-width": "75%", "flex": "0 0 75%" });
                $(".grow1,.grow2,.grow3").css({ "width": "20.3vw" });
                $("#left1, #right1, #last1").css({ "width": "22vw" });
            }
            $(this).hide();
            $("#fullscreen").show();
            $("hr.hori").css({ "margin-left": "0.1vw" });


        });
    });
</script>

<script>
    $(document).on('click', '.chat_send', function (e) {                     

        e.preventDefault();
        

        var csrftoken = getCookie('csrftoken');

        var buttonValue1 = $(this).val();
       
        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_chat',

            data: {
                task_id: buttonValue1,
                chat: $('#comnt' + buttonValue1).val(),
                csrfmiddlewaretoken: csrftoken,
            },
            success: function (data) {
                
                var show_data = `
                    <div class="row">
                        <div class="profCont5 my-chat">
                            <img class="profile5" src="../{{request.session.profile_pic}}">
                            <div class="txt5">
                                <div class="row mycomment">
                                    <div class="col-md-12"> {{request.session.name}} </div>
                                </div>
                                ${data.data}
                            </div>
                        </div>
                    </div>`;
                $("#notificationdetails" + buttonValue1).append(show_data);
                $("#notificationdetails_inner" + buttonValue1).append(show_data);
                
                $(".empty").val('').empty();                                      
                var modalEmail = $("#modalEmail" + buttonValue1);
                modalEmail.scrollTop(modalEmail.prop("scrollHeight"));                
            }

        });

        // setInterval(sendReq, 750);
    });

    // Function to retrieve the CSRF token from the cookie
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>



<script>
    $(document).on('click', '.comment_button', function (e) {
        e.preventDefault();
        var flag = 0;
        var buttonValue = $(this).val();
        var csrftoken = getCookie('csrftoken');
        console.log(buttonValue);
        sendReq(buttonValue,flag)

        var Interval = setInterval(function () { sendReq(buttonValue,1); }, 750);
        $('.stopInterval').on('click', () => {
            clearInterval(Interval);
        });
    });
    function sendReq(buttonValue,flag) {

        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_chat_refresh',
            data: {
                task_id: buttonValue,
                csrfmiddlewaretoken: getCookie('csrftoken'),
            },
            
            success: function (x) {
                for (var i = 0; i < x.data.length; i++) {
                    var show_data = `
                    <div class="row">
                    <div class="profCont team-chat" >
                        <img class="profile" src="../static/img/profiles/img-2.jpg">
                       <div class="txt2">
                        <div class="row commentername" >
                            <div class="col-md-12 ">
                                <p> ${x.name} </p>
                            </div>
                        </div>
                        ${x.data}</div>
                     </div>
                    </div>`;
                    $("#notificationdetails" + buttonValue).append(show_data);
                    $("#notificationdetails_inner" + buttonValue).append(show_data);
                }
                // alert("flag :" + flag);
                if(flag == 0){
                    
                    var modalEmail = $("#modalEmail" + buttonValue);
                    // alert("buttonValue: " + buttonValue);
                    modalEmail.scrollTop(modalEmail.prop("scrollHeight"));
                    // alert("modalEmail: " + modalEmail);
                }
            }

        });

    }


    // Function to retrieve the CSRF token from the cookie
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

<script>
    function openPopup1() {
        $("#popup1").fadeIn();
    }
    function closePopup1() {
        $("#popup1").fadeOut();
    }
</script>
<script>
    function openPopup2() {
        $("#popup2").fadeIn();
    }
    function closePopup2() {
        $("#popup2").fadeOut();
    }
</script>
<script>
    function openPopup3() {
        $("#popup3").fadeIn();
    }
    function closePopup3() {
        $("#popup3").fadeOut();
    }
</script>


<!-- <script>
    $(document).ready(function () {
        var $modalBody = $("#modalEmail");
        var isScrolledToBottom = true;

        function scrollToBottom() {
            $modalBody.scrollTop($modalBody[0].scrollHeight);
            isScrolledToBottom = true;
        }
        scrollToBottom();
        setInterval(function () {
            if (isScrolledToBottom) {
                scrollToBottom();
            }
        }, 2000); // Adjust the interval as needed
        $modalBody.on('scroll', function () {
            isScrolledToBottom = $modalBody[0].scrollHeight - $modalBody.scrollTop() === $modalBody.height();
        });
    });
</script> -->
<script>
    $(document).on('click', '.status_mark_ui', function (e) {

        e.preventDefault();
        // Get the CSRF token from the cookie
        var csrftoken = getCookie('csrftoken');
        var buttonValue = $(this).val();

        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_status_mark',

            data: {
                task_id: buttonValue,
                chat: 'ui',
                csrfmiddlewaretoken: csrftoken,
            },
            success: function () {
            }

        });
    });
    // Function to retrieve the CSRF token from the cookie
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>
<script>
    $(document).on('click', '.status_mark_bc', function (e) {

        e.preventDefault();
        // Get the CSRF token from the cookie
        var csrftoken = getCookie('csrftoken');
        var buttonValue = $(this).val();

        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_status_mark',
            data: {
                task_id: buttonValue,
                chat: 'bc',
                csrfmiddlewaretoken: csrftoken,
            },
            success: function () {
            }
        });
    });
    // Function to retrieve the CSRF token from the cookie
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>
<script>
    $(document).on('click', '.status_mark_db', function (e) {

        e.preventDefault();
        // Get the CSRF token from the cookie
        var csrftoken = getCookie('csrftoken');
        var buttonValue = $(this).val();

        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_status_mark',

            data: {
                task_id: buttonValue,
                chat: 'db',
                csrfmiddlewaretoken: csrftoken,
            },
            success: function () {
            }
        });
    });

    // Function to retrieve the CSRF token from the cookie
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>
<!-- .teamMember {
    border: 3px solid darkgray;
    font-weight: 600;
    box-shadow: 1px 6px 25px 3px darkcyan;
  } -->
<script>
    $(document).ready(function(){
        $(".TeamDiv").hide();
        $(".teamList").mouseenter(function(){
            $(".TeamDiv").show();
            $(".teamMember").css({"box-shadow":"1px 6px 25px 3px darkcyan"});
        });
        $(".teamList").mouseleave(function(){
            $(".TeamDiv").hide();
            $(".teamMember").css({"box-shadow":"1px 6px 25px 3px darkcyan"});

        });
    });
</script>
<script>
    $(document).ready(function(){
        $(".popup_icons_attach").click(function(){
                $(this).css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
        });
        $(".modalbodydesk,.task_details_head,.popup_icons_user").click(function(){
            $(".popup_icons_attach").css({"border-bottom":"none","width":"auto","border-radius":"none","background":"none","color":"black"});
        });
    });
</script>
<script>
    $(document).on('click', '.chat_send_inner', function (e) {
        e.preventDefault();
        var csrftoken = getCookie('csrftoken');
        var buttonValue = $(this).val();
        console.log(buttonValue);
        console.log($('#comnt_inner' + buttonValue).val());
        $.ajax({
            type: 'POST',
            url: '../clientmanager/task_chat',
            data: {
                task_id: buttonValue,
                chat: $('#comnt_inner' + buttonValue).val(),
                csrfmiddlewaretoken: csrftoken,
            },
            success: function (data) {
            var show_data = `
                <div class="row">
                    <div class="profCont5 my-chat">
                        <img class="profile5" src="../{{request.session.profile_pic}}">
                        <div class="txt5">
                            <div class="row mycomment">
                                <div class="col-md-12"> {{request.session.name}} </div>
                            </div>
                            ${data.data}
                        </div>
                    </div>
                </div>`;
            console.log(data.data);
            $("#notificationdetails_inner" + buttonValue).append(show_data);
            $("#notificationdetails" + buttonValue).append(show_data);

            // Scroll to the bottom
            var modalEmail_inner_first = $("#modalEmail_inner_first" + buttonValue);
                modalEmail_inner_first.scrollTop(modalEmail_inner_first.prop("scrollHeight"));                //  set scrollbar at bottom
                var modalEmail_inner_sec = $("#modalEmail_inner_sec" + buttonValue);
                modalEmail_inner_sec.scrollTop(modalEmail_inner_sec.prop("scrollHeight")); 
                var modalEmail_inner_last = $("#modalEmail_inner_last" + buttonValue);
                modalEmail_inner_last.scrollTop(modalEmail_inner_last.prop("scrollHeight")); 

            // Clear input value
            
        }
        
        });
        $(".empty").val('').empty(); 
    });

    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>

<!-- <script>
    $(document).ready(function(){
        $(".nops").show(function(){
            $(".popup_icons_user").css({"border-bottom":"3px solid black","width":"100%","border-radius":"10px","background":"#09796b","color":"white"});
                                                   
        });
        $(".nops").hide(function(){
            $(".popup_icons_user").css({"border-bottom":"none","width":"auto","border-radius":"none","background":"none","color":"black"});
                                                   
        });
    });
</script> -->
<script>
    $(document).ready(function(){
        $('.status_dropdown').change(function(){
            var task_status = $(this).val();
            var csrftoken = getCookie('csrftoken');
            $.ajax({
                url: '../clientmanager/change_task_status',
                method: 'POST', 
                data: {
                    task:task_status,
                    csrfmiddlewaretoken: csrftoken,
                }, 

                success: function(response){
                    console.log(response);
                },
                error: function(xhr, status, error){
                    console.error(xhr.responseText);
                }
            });
        });
    });
    function getCookie(name) {
        var cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
</script>



{% endblock body %}